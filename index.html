<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nepean School ‚Äì WhatsApp Group Chat Safety</title>
<style>
/* ========== RESET & BASE ========== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  /* WhatsApp palette */
  --wa-dark-green: #075E54;
  --wa-teal: #128C7E;
  --wa-light-green: #25D366;
  --wa-lime: #DCF8C6;
  --wa-chat-bg: #ECE5DD;
  --wa-white: #FFFFFF;
  --wa-bubble-out: #DCF8C6;
  --wa-bubble-in: #FFFFFF;
  --wa-text: #303030;
  --wa-meta: #667781;
  --wa-danger: #E74C3C;
  --wa-warning: #F39C12;
  --wa-safe: #25D366;
  --wa-info: #3498DB;
  --wa-star: #F1C40F;
  --wa-header-h: 56px;

  /* Feedback colours */
  --fb-good: #D4EDDA;
  --fb-good-border: #28A745;
  --fb-caution: #FFF3CD;
  --fb-caution-border: #FFC107;
  --fb-bad: #F8D7DA;
  --fb-bad-border: #DC3545;
}

/* Universal primary-school-friendly font stack */
body {
  font-family: "Nunito", "Comic Neue", "Andika", "OpenDyslexic", "Sassoon Primary", "Century Gothic", "Apple SD Gothic Neo", "Trebuchet MS", "Verdana", "Tahoma", sans-serif;
  background: var(--wa-chat-bg);
  color: var(--wa-text);
  line-height: 1.5;
  font-size: 17px;
  -webkit-font-smoothing: antialiased;
}

/* Google Fonts ‚Äì Nunito (rounded, friendly, highly legible) */
@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');

/* ========== SPLASH / TABLE OF CONTENTS ========== */
#splash {
  min-height: 100vh;
  background: linear-gradient(135deg, var(--wa-dark-green) 0%, var(--wa-teal) 60%, var(--wa-light-green) 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 30px 16px 60px;
  color: #fff;
}
#splash h1 {
  font-size: clamp(1.5rem, 4vw, 2.2rem);
  font-weight: 800;
  text-align: center;
  margin: 20px 0 6px;
  letter-spacing: -0.5px;
}
#splash .subtitle {
  font-size: clamp(0.95rem, 2.5vw, 1.15rem);
  opacity: 0.9;
  text-align: center;
  margin-bottom: 28px;
  max-width: 520px;
}
.logo-icon {
  width: 72px; height: 72px;
  background: rgba(255,255,255,0.15);
  border-radius: 20px;
  display: flex; align-items: center; justify-content: center;
  font-size: 38px;
  margin-top: 10px;
}

/* ========== INTRO PAGE ========== */
#intro {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: #04332e;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 200;
  overflow: hidden;
  transition: opacity 0.5s ease;
}
#intro.hidden { display: none; }

/* Top text */
.intro-text-top, .intro-text-bottom {
  color: #fff;
  font-weight: 800;
  text-align: center;
  overflow: hidden;
  min-height: 1.6em;
}
.intro-text-top {
  font-size: clamp(1.6rem, 5vw, 2.6rem);
  margin-bottom: 18px;
  letter-spacing: -0.3px;
}
.intro-text-bottom {
  font-size: clamp(1rem, 3vw, 1.5rem);
  margin-top: 18px;
  color: var(--wa-light-green);
  letter-spacing: 0.3px;
}
.intro-typed-cursor {
  display: inline-block;
  width: 3px;
  height: 1em;
  background: var(--wa-light-green);
  margin-left: 3px;
  vertical-align: text-bottom;
  animation: cursorBlink 0.7s step-end infinite;
}

/* Logo container with neon ring */
.intro-logo-wrap {
  position: relative;
  width: 200px;
  height: 200px;
  cursor: pointer;
  flex-shrink: 0;
}
@media (min-width: 500px) {
  .intro-logo-wrap { width: 260px; height: 260px; }
}

/* Neon ring ‚Äì rotating conic gradient */
.intro-neon-ring {
  position: absolute;
  top: -6px; left: -6px; right: -6px; bottom: -6px;
  border-radius: 50%;
  background: conic-gradient(
    from 0deg,
    #25D366 0deg,
    #00ffcc 60deg,
    transparent 120deg,
    transparent 240deg,
    #25D366 300deg,
    #00ffcc 360deg
  );
  animation: neonSpin 2.5s linear infinite;
  filter: blur(2px);
}
@keyframes neonSpin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Secondary outer glow ring */
.intro-neon-ring::after {
  content: '';
  position: absolute;
  top: -4px; left: -4px; right: -4px; bottom: -4px;
  border-radius: 50%;
  background: conic-gradient(
    from 180deg,
    transparent 0deg,
    rgba(37,211,102,0.4) 90deg,
    transparent 180deg,
    rgba(0,255,204,0.3) 270deg,
    transparent 360deg
  );
  animation: neonSpin 3.5s linear infinite reverse;
  filter: blur(6px);
}

/* Inner mask to make it a ring */
.intro-neon-inner {
  position: absolute;
  top: 5px; left: 5px; right: 5px; bottom: 5px;
  border-radius: 50%;
  background: #04332e;
  z-index: 1;
}

/* Actual logo image */
.intro-logo-img {
  position: absolute;
  top: 10px; left: 10px; right: 10px; bottom: 10px;
  border-radius: 50%;
  overflow: hidden;
  z-index: 2;
  display: flex;
  align-items: center;
  justify-content: center;
}
.intro-logo-img img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

/* Neon ambient glow beneath */
.intro-logo-wrap::after {
  content: '';
  position: absolute;
  top: 10%; left: 10%; width: 80%; height: 80%;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(37,211,102,0.25) 0%, transparent 70%);
  filter: blur(20px);
  z-index: 0;
  animation: ambientPulse 2s ease-in-out infinite;
}
@keyframes ambientPulse {
  0%, 100% { opacity: 0.6; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.1); }
}

/* Click hint */
.intro-click-hint {
  color: rgba(255,255,255,0.4);
  font-size: 0.78rem;
  font-weight: 600;
  margin-top: 24px;
  letter-spacing: 1px;
  text-transform: uppercase;
  animation: hintPulse 2s ease-in-out infinite;
  opacity: 0;
}
.intro-click-hint.show { opacity: 1; }
@keyframes hintPulse {
  0%, 100% { opacity: 0.35; }
  50% { opacity: 0.7; }
}

/* Portal zoom transition */
#intro.portal-out {
  pointer-events: none;
}
#intro.portal-out .intro-logo-wrap {
  animation: portalZoom 1s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}
#intro.portal-out .intro-text-top,
#intro.portal-out .intro-text-bottom,
#intro.portal-out .intro-click-hint {
  animation: portalFadeText 0.4s ease forwards;
}
@keyframes portalZoom {
  0% { transform: scale(1); opacity: 1; }
  40% { transform: scale(1.2); opacity: 1; }
  100% { transform: scale(25); opacity: 0; }
}
@keyframes portalFadeText {
  0% { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(-20px); }
}

/* ========== LANDING PAGE ========== */
#landing {
  min-height: 100vh;
  background: linear-gradient(160deg, #04332e 0%, #075E54 35%, #0a7a6e 65%, #128C7E 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 30px 20px;
  color: #fff;
  position: relative;
  overflow: hidden;
}
#landing.hidden { display: none; }

/* Neon grid background effect */
#landing::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background:
    linear-gradient(rgba(37,211,102,0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(37,211,102,0.04) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events: none;
}
#landing::after {
  content: '';
  position: absolute;
  top: -50%; left: -50%;
  width: 200%; height: 200%;
  background: radial-gradient(ellipse at 60% 40%, rgba(37,211,102,0.1) 0%, transparent 60%);
  pointer-events: none;
}

.landing-content {
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  max-width: 440px;
  width: 100%;
}

/* Character image placeholder */
.landing-character {
  width: 220px;
  height: 260px;
  border-radius: 24px;
  border: 3px solid rgba(37,211,102,0.4);
  background: linear-gradient(135deg, rgba(37,211,102,0.1), rgba(18,140,126,0.15));
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin-bottom: 8px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 0 30px rgba(37,211,102,0.15), inset 0 0 30px rgba(37,211,102,0.05);
}
.landing-character img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 21px;
  position: absolute;
  top: 0; left: 0;
}
.landing-character .placeholder-icon {
  font-size: 4.5rem;
  margin-bottom: 6px;
  filter: drop-shadow(0 0 8px rgba(37,211,102,0.4));
}
.landing-character .placeholder-text {
  font-size: 0.7rem;
  opacity: 0.5;
  text-align: center;
  padding: 0 16px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Neon glow accents on character */
.landing-character::before {
  content: '';
  position: absolute;
  top: -2px; left: -2px; right: -2px; bottom: -2px;
  border-radius: 26px;
  background: linear-gradient(135deg, #25D366, transparent 40%, transparent 60%, #25D366);
  z-index: -1;
  opacity: 0.3;
  animation: neonPulse 3s ease-in-out infinite;
}
@keyframes neonPulse {
  0%, 100% { opacity: 0.2; }
  50% { opacity: 0.5; }
}

/* Speech bubble */
.landing-bubble-wrap {
  position: relative;
  width: 100%;
  margin-bottom: 24px;
}
.landing-bubble {
  background: var(--wa-white);
  color: var(--wa-text);
  border-radius: 16px;
  border-top-left-radius: 4px;
  padding: 16px 18px;
  font-size: 1rem;
  line-height: 1.55;
  position: relative;
  box-shadow: 0 4px 16px rgba(0,0,0,0.12);
  min-height: 80px;
}
.landing-bubble::before {
  content: '';
  position: absolute;
  top: -8px;
  left: 32px;
  width: 0; height: 0;
  border-left: 8px solid transparent;
  border-right: 8px solid transparent;
  border-bottom: 8px solid var(--wa-white);
}
.landing-bubble .typing-cursor {
  display: inline-block;
  width: 2px;
  height: 1.1em;
  background: var(--wa-dark-green);
  margin-left: 2px;
  vertical-align: text-bottom;
  animation: cursorBlink 0.7s step-end infinite;
}
@keyframes cursorBlink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}
.landing-bubble .bubble-time {
  display: block;
  text-align: right;
  font-size: 0.68rem;
  color: var(--wa-meta);
  margin-top: 6px;
}

/* Enter button */
.landing-enter-btn {
  background: linear-gradient(135deg, #25D366, #20bd5a);
  color: #fff;
  border: none;
  border-radius: 50px;
  padding: 16px 44px;
  font-size: 1.15rem;
  font-weight: 800;
  font-family: inherit;
  cursor: pointer;
  letter-spacing: 0.5px;
  box-shadow: 0 0 20px rgba(37,211,102,0.4), 0 4px 14px rgba(0,0,0,0.2);
  transition: transform 0.15s, box-shadow 0.2s;
  display: flex;
  align-items: center;
  gap: 10px;
  opacity: 0;
  transform: translateY(10px);
  animation: enterBtnAppear 0.5s ease forwards;
  animation-delay: 4s;
}
.landing-enter-btn:hover {
  transform: translateY(-3px) scale(1.03);
  box-shadow: 0 0 30px rgba(37,211,102,0.5), 0 6px 20px rgba(0,0,0,0.25);
}
.landing-enter-btn:active { transform: translateY(0) scale(0.98); }
@keyframes enterBtnAppear {
  to { opacity: 1; transform: translateY(0); }
}

/* Title row on splash */
.splash-title-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 14px;
  margin: 10px 0 4px;
  flex-wrap: nowrap;
  width: 100%;
  max-width: 860px;
}
.splash-title-row .school-word {
  font-size: clamp(2.2rem, 7vw, 3.6rem);
  font-weight: 800;
  letter-spacing: -0.5px;
  white-space: nowrap;
  flex: 1;
}
.splash-title-row .school-word:first-child {
  text-align: right;
}
.splash-title-row .school-word:last-child {
  text-align: left;
}
.splash-title-row .logo-icon {
  margin: 0;
  width: 62px; height: 62px;
  font-size: 34px;
  flex-shrink: 0;
}
.toc-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
  width: 100%;
  max-width: 860px;
}
.toc-card {
  background: rgba(255,255,255,0.13);
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,0.18);
  border-radius: 14px;
  padding: 14px 16px;
  cursor: pointer;
  transition: transform 0.15s, background 0.2s;
  display: flex;
  align-items: center;
  gap: 12px;
}
.toc-card:hover, .toc-card:focus-visible {
  background: rgba(255,255,255,0.22);
  transform: translateY(-2px);
}
.toc-num {
  min-width: 34px; height: 34px;
  background: var(--wa-light-green);
  color: var(--wa-dark-green);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-weight: 800;
  font-size: 0.9rem;
  flex-shrink: 0;
}
.toc-label {
  font-weight: 600;
  font-size: 0.97rem;
  line-height: 1.35;
}
.toc-card .toc-tag {
  margin-left: auto;
  font-size: 0.7rem;
  background: rgba(255,255,255,0.2);
  padding: 2px 8px;
  border-radius: 8px;
  white-space: nowrap;
}

/* Student name input */
.name-input-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,0.25);
  border-radius: 14px;
  padding: 12px 16px;
  margin-bottom: 20px;
  width: auto;
  max-width: 400px;
  overflow: hidden;
}
.name-input-bar label {
  font-weight: 700;
  font-size: 0.95rem;
  white-space: nowrap;
  flex-shrink: 0;
}
.name-input-bar input {
  flex: 1;
  min-width: 0;
  width: 100%;
  background: rgba(255,255,255,0.9);
  border: 2px solid rgba(255,255,255,0.4);
  border-radius: 10px;
  padding: 9px 12px;
  font-size: 0.95rem;
  font-family: inherit;
  font-weight: 600;
  color: var(--wa-dark-green);
  outline: none;
  transition: border-color 0.2s;
}
.name-input-bar input::placeholder {
  color: #999;
  font-weight: 400;
}
.name-input-bar input:focus {
  border-color: var(--wa-light-green);
  box-shadow: 0 0 0 3px rgba(37,211,102,0.25);
}

/* Print worksheet button */
.print-worksheet-btn {
  background: linear-gradient(135deg, var(--wa-dark-green), var(--wa-teal));
  color: #fff;
  border: none;
  border-radius: 14px;
  padding: 14px 28px;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: transform 0.15s, box-shadow 0.2s;
  box-shadow: 0 3px 12px rgba(7,94,84,0.3);
}
.print-worksheet-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 18px rgba(7,94,84,0.4);
}
.print-worksheet-btn:active { transform: translateY(0); }

/* Practice name display */
.practice-name-row {
  display: flex;
  align-items: center;
  gap: 10px;
  background: var(--wa-lime);
  border-radius: 12px;
  padding: 10px 16px;
  margin-bottom: 14px;
  flex-wrap: wrap;
}
.practice-name-row label {
  font-weight: 700;
  font-size: 0.9rem;
  color: var(--wa-dark-green);
}
.practice-name-row input {
  flex: 1;
  min-width: 160px;
  background: #fff;
  border: 2px solid var(--wa-light-green);
  border-radius: 10px;
  padding: 8px 12px;
  font-size: 0.95rem;
  font-family: inherit;
  font-weight: 600;
  color: var(--wa-dark-green);
  outline: none;
}
.practice-name-row input:focus {
  border-color: var(--wa-dark-green);
  box-shadow: 0 0 0 3px rgba(37,211,102,0.2);
}

/* ========== SIMULATION SHELL ========== */
#sim-container {
  display: none;
  max-width: 480px;
  margin: 0 auto;
  min-height: 100vh;
  background: var(--wa-chat-bg);
  position: relative;
  flex-direction: column;
}
#sim-container.active { display: flex; }

/* Header bar */
.sim-header {
  background: var(--wa-dark-green);
  color: #fff;
  display: flex;
  align-items: center;
  padding: 10px 12px;
  gap: 10px;
  position: sticky;
  top: 0;
  z-index: 50;
  min-height: var(--wa-header-h);
}
.sim-header .back-btn {
  background: none; border: none; color: #fff;
  font-size: 1.4rem; cursor: pointer; padding: 4px;
  display: flex; align-items: center;
}
.sim-header .group-avatar {
  width: 38px; height: 38px;
  background: var(--wa-teal);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.1rem;
  flex-shrink: 0;
}
.sim-header .group-info {
  flex: 1;
  overflow: hidden;
}
.sim-header .group-name {
  font-weight: 700;
  font-size: 1rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.sim-header .group-members {
  font-size: 0.72rem;
  opacity: 0.8;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.sim-header .safety-btn {
  background: none; border: 2px solid rgba(255,255,255,0.5);
  color: #fff; border-radius: 50%;
  width: 36px; height: 36px;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; font-size: 1.1rem;
  transition: background 0.2s;
  flex-shrink: 0;
}
.sim-header .safety-btn:hover { background: rgba(255,255,255,0.15); }
.sim-header .safety-btn.flash {
  animation: safetyFlash 1s ease-in-out infinite;
}
@keyframes safetyFlash {
  0%, 100% { border-color: rgba(255,255,255,0.5); }
  50% { border-color: #F1C40F; background: rgba(241,196,15,0.25); }
}

/* Score bar */
.score-bar {
  background: var(--wa-teal);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 14px;
  font-size: 0.82rem;
  font-weight: 600;
}
.score-bar .stars { letter-spacing: 2px; font-size: 1rem; }
.score-bar .step-indicator { opacity: 0.85; }

/* Accessibility toggles bar */
.a11y-bar {
  background: #f0ebe4;
  display: flex;
  gap: 6px;
  padding: 6px 10px;
  flex-wrap: wrap;
  border-bottom: 1px solid #d4cfc8;
}
.a11y-btn {
  background: var(--wa-white);
  border: 1.5px solid #c5c0b8;
  border-radius: 20px;
  padding: 4px 12px;
  font-size: 0.78rem;
  font-weight: 600;
  cursor: pointer;
  display: flex; align-items: center; gap: 5px;
  transition: background 0.15s;
  font-family: inherit;
  color: var(--wa-text);
}
.a11y-btn:hover { background: #e8e3dc; }
.a11y-btn.on { background: var(--wa-lime); border-color: var(--wa-light-green); }

/* Chat area */
.chat-area {
  flex: 1;
  overflow-y: auto;
  padding: 12px 14px 20px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  background: var(--wa-chat-bg);
  /* WhatsApp doodle pattern placeholder */
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" fill="%23d6d0c6" opacity="0.25"><text x="10" y="30" font-size="14">üí¨</text><text x="90" y="70" font-size="12">üì±</text><text x="40" y="120" font-size="14">üîí</text><text x="140" y="40" font-size="13">üõ°Ô∏è</text><text x="150" y="150" font-size="12">‚ù§Ô∏è</text><text x="20" y="180" font-size="13">‚ú®</text></svg>');
}

/* Date divider */
.chat-date {
  align-self: center;
  background: #E1D8CC;
  color: var(--wa-meta);
  font-size: 0.72rem;
  font-weight: 600;
  padding: 4px 14px;
  border-radius: 8px;
  margin: 8px 0;
}

/* Bubbles */
.bubble-row {
  display: flex;
  flex-direction: column;
  max-width: 82%;
  animation: bubbleIn 0.3s ease;
}
@keyframes bubbleIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}
.bubble-row.incoming { align-self: flex-start; }
.bubble-row.outgoing { align-self: flex-end; }
.bubble-sender {
  font-size: 0.74rem;
  font-weight: 700;
  margin-bottom: 1px;
  padding-left: 4px;
}
.bubble {
  padding: 7px 10px 4px;
  border-radius: 10px;
  position: relative;
  line-height: 1.45;
  font-size: 0.95rem;
  word-wrap: break-word;
}
.bubble-row.incoming .bubble {
  background: var(--wa-bubble-in);
  border-top-left-radius: 2px;
}
.bubble-row.outgoing .bubble {
  background: var(--wa-bubble-out);
  border-top-right-radius: 2px;
}
.bubble .fwd-label {
  display: flex; align-items: center; gap: 4px;
  font-size: 0.72rem;
  color: var(--wa-meta);
  font-style: italic;
  margin-bottom: 3px;
}
.bubble .msg-text { margin-bottom: 2px; }
.bubble .meta-row {
  display: flex; justify-content: flex-end; align-items: center; gap: 4px;
  font-size: 0.65rem; color: var(--wa-meta);
}

/* Video thumbnail placeholder */
.video-thumb {
  background: #222;
  border-radius: 8px;
  width: 100%;
  aspect-ratio: 16/9;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-size: 2.2rem;
  margin-bottom: 6px;
  position: relative;
  overflow: hidden;
}
.video-thumb .play-circle {
  width: 52px; height: 52px;
  background: rgba(255,255,255,0.25);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
}
.video-thumb img {
  width: 100%; height: 100%; object-fit: cover;
  position: absolute; top: 0; left: 0;
}

/* Image placeholder */
.img-placeholder {
  background: #ddd;
  border-radius: 8px;
  width: 100%;
  aspect-ratio: 4/3;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #999;
  font-size: 0.85rem;
  font-weight: 600;
  border: 2px dashed #bbb;
  margin-bottom: 6px;
}

/* System message */
.system-msg {
  align-self: center;
  background: #FFF9C4;
  color: #5D4037;
  font-size: 0.78rem;
  font-weight: 600;
  padding: 5px 14px;
  border-radius: 8px;
  margin: 6px 0;
  text-align: center;
  max-width: 88%;
}

/* ========== ACTION BAR ========== */
.action-bar {
  background: #fff;
  border-top: 1px solid #d4cfc8;
  padding: 12px 10px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: center;
}
.action-btn {
  background: var(--wa-dark-green);
  color: #fff;
  border: none;
  border-radius: 24px;
  padding: 10px 18px;
  font-size: 0.92rem;
  font-weight: 700;
  cursor: pointer;
  font-family: inherit;
  transition: transform 0.12s, box-shadow 0.15s, background 0.15s;
  display: flex; align-items: center; gap: 6px;
}
.action-btn:hover { background: var(--wa-teal); transform: scale(1.04); box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
.action-btn:active { transform: scale(0.97); }
.action-btn.danger { background: var(--wa-danger); }
.action-btn.danger:hover { background: #c0392b; }
.action-btn.warning { background: var(--wa-warning); color: #333; }
.action-btn.safe { background: var(--wa-light-green); color: #065840; }

/* ========== FEEDBACK PANEL ========== */
.feedback-panel {
  display: none;
  margin: 0 10px 10px;
  padding: 14px 16px;
  border-radius: 14px;
  border-left: 5px solid;
  animation: feedbackIn 0.35s ease;
  font-size: 0.92rem;
}
@keyframes feedbackIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.feedback-panel.show { display: block; }
.feedback-panel.good { background: var(--fb-good); border-color: var(--fb-good-border); }
.feedback-panel.caution { background: var(--fb-caution); border-color: var(--fb-caution-border); }
.feedback-panel.bad { background: var(--fb-bad); border-color: var(--fb-bad-border); }
.feedback-panel h4 { font-size: 1rem; margin-bottom: 4px; }
.feedback-panel .next-btn {
  margin-top: 10px;
  background: var(--wa-dark-green);
  color: #fff;
  border: none;
  border-radius: 20px;
  padding: 8px 20px;
  font-weight: 700;
  cursor: pointer;
  font-family: inherit;
  font-size: 0.88rem;
}
.feedback-panel .retry-btn {
  margin-top: 10px;
  margin-left: 6px;
  background: transparent;
  color: var(--wa-dark-green);
  border: 2px solid var(--wa-dark-green);
  border-radius: 20px;
  padding: 7px 18px;
  font-weight: 700;
  cursor: pointer;
  font-family: inherit;
  font-size: 0.88rem;
}

/* ========== HELP PANEL (side drawer) ========== */
.help-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.45);
  z-index: 100;
  animation: fadeIn 0.2s;
}
.help-overlay.show { display: block; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.help-panel {
  position: fixed;
  top: 0; right: -320px; bottom: 0;
  width: 310px;
  max-width: 90vw;
  background: #fff;
  z-index: 101;
  padding: 24px 18px;
  overflow-y: auto;
  transition: right 0.3s ease;
  box-shadow: -4px 0 20px rgba(0,0,0,0.15);
}
.help-panel.show { right: 0; }
.help-panel h3 {
  color: var(--wa-dark-green);
  font-size: 1.15rem;
  margin-bottom: 14px;
  display: flex; align-items: center; gap: 8px;
}
.help-panel .close-help {
  position: absolute; top: 14px; right: 14px;
  background: none; border: none;
  font-size: 1.4rem; cursor: pointer; color: #888;
}
.help-steps { list-style: none; margin: 10px 0 18px; }
.help-steps li {
  padding: 8px 0 8px 36px;
  position: relative;
  font-size: 0.92rem;
  border-bottom: 1px solid #eee;
}
.help-steps li::before {
  content: attr(data-step);
  position: absolute; left: 0; top: 8px;
  width: 26px; height: 26px;
  background: var(--wa-light-green);
  color: var(--wa-dark-green);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-weight: 800; font-size: 0.8rem;
}
.trusted-adult-btn {
  width: 100%;
  background: var(--wa-dark-green);
  color: #fff;
  border: none;
  border-radius: 12px;
  padding: 14px;
  font-size: 0.95rem;
  font-weight: 700;
  cursor: pointer;
  font-family: inherit;
  margin-top: 8px;
}
.trusted-contacts {
  display: none;
  background: #f7f7f7;
  border-radius: 10px;
  padding: 6px 14px;
  margin-top: 10px;
}
.trusted-contacts.show { display: block; }
.trusted-contacts .tc-item {
  padding: 10px 0;
  border-bottom: 1px solid #eee;
  display: grid;
  grid-template-columns: 28px 1fr;
  gap: 8px;
  align-items: start;
  font-size: 0.88rem;
  line-height: 1.45;
}
.trusted-contacts .tc-item:last-child { border-bottom: none; }
.trusted-contacts .tc-icon {
  font-size: 1.1rem;
  text-align: center;
  padding-top: 1px;
}
.trusted-contacts .tc-name {
  font-weight: 700;
}
.trusted-contacts .tc-desc {
  color: #555;
}

/* ========== DEBRIEF CARD ========== */
.debrief-card {
  display: none;
  background: #fff;
  border-radius: 16px;
  margin: 12px;
  padding: 20px 18px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  border-top: 5px solid var(--wa-light-green);
  animation: feedbackIn 0.4s ease;
}
.debrief-card.show { display: block; }
.debrief-card h3 {
  color: var(--wa-dark-green);
  font-size: 1.08rem;
  margin-bottom: 10px;
  display: flex; align-items: center; gap: 8px;
}
.debrief-card .debrief-section {
  margin-bottom: 12px;
}
.debrief-card .debrief-section h4 {
  font-size: 0.88rem;
  color: var(--wa-teal);
  margin-bottom: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.debrief-card .debrief-section p {
  font-size: 0.9rem;
  line-height: 1.5;
}
.debrief-card .reminder-box {
  background: #FFF8E1;
  border-radius: 10px;
  padding: 10px 14px;
  font-size: 0.88rem;
  display: flex; align-items: flex-start; gap: 8px;
  margin-top: 8px;
}
.debrief-card .finish-btns {
  display: flex; gap: 8px; margin-top: 14px; flex-wrap: wrap;
}
.debrief-card .finish-btn {
  flex: 1;
  min-width: 120px;
  padding: 10px;
  border-radius: 12px;
  border: none;
  font-weight: 700;
  font-size: 0.9rem;
  cursor: pointer;
  font-family: inherit;
}
.debrief-card .finish-btn.primary { background: var(--wa-dark-green); color: #fff; }
.debrief-card .finish-btn.secondary { background: #eee; color: var(--wa-text); }

/* ========== PRACTICE MODE ========== */
.practice-container {
  display: none;
  padding: 16px;
}
.practice-container.show { display: block; }
.practice-q-card {
  background: #fff;
  border-radius: 14px;
  padding: 18px;
  margin-bottom: 14px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}
.practice-q-card .q-num {
  font-size: 0.75rem;
  color: var(--wa-teal);
  font-weight: 700;
  text-transform: uppercase;
  margin-bottom: 6px;
}
.practice-q-card .q-text {
  font-size: 0.95rem;
  font-weight: 600;
  margin-bottom: 12px;
}
.practice-q-card .q-options { display: flex; flex-direction: column; gap: 8px; }
.practice-q-card .q-opt {
  background: #f5f5f5;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  padding: 10px 14px;
  cursor: pointer;
  font-size: 0.9rem;
  font-family: inherit;
  text-align: left;
  transition: border-color 0.15s, background 0.15s;
  font-weight: 500;
}
.practice-q-card .q-opt:hover { border-color: var(--wa-teal); background: #e8f5e9; }
.practice-q-card .q-opt.correct { border-color: var(--fb-good-border); background: var(--fb-good); }
.practice-q-card .q-opt.wrong { border-color: var(--fb-bad-border); background: var(--fb-bad); }
.practice-q-card .q-opt.disabled { pointer-events: none; opacity: 0.7; }
.practice-q-card .q-feedback {
  display: none;
  margin-top: 10px;
  font-size: 0.88rem;
  padding: 8px 12px;
  border-radius: 10px;
}
.practice-q-card .q-feedback.show { display: block; }

/* ========== EASY READ MODE ========== */
body.easy-read .bubble { font-size: 1.1rem; line-height: 1.6; }
body.easy-read .action-btn { font-size: 1.05rem; padding: 12px 22px; }
body.easy-read .feedback-panel { font-size: 1.05rem; }

/* ========== REDUCE CLUTTER MODE ========== */
body.reduce-clutter .emoji-sticker { display: none; }
body.reduce-clutter .video-thumb { display: none; }
body.reduce-clutter .img-placeholder { display: none; }

/* ========== RESPONSIVE ========== */
@media (max-width: 520px) {
  #sim-container { max-width: 100%; }
  .toc-grid { grid-template-columns: 1fr; }
  .bubble-row { max-width: 90%; }
}
@media (min-width: 768px) {
  #sim-container {
    border-left: 1px solid #ccc;
    border-right: 1px solid #ccc;
    min-height: 100vh;
  }
}

/* ========== PRINT ========== */
@media print {
  #intro, #landing, #splash, .a11y-bar, .action-bar, .score-bar { display: none; }
}
</style>
</head>
<body>

<!-- ===================== INTRO PAGE ===================== -->
<div id="intro">
  <div class="intro-text-top">
    <span id="introTopText"></span><span class="intro-typed-cursor" id="introTopCursor"></span>
  </div>

  <div class="intro-logo-wrap" id="introLogoWrap" onclick="triggerPortal()">
    <div class="intro-neon-ring"></div>
    <div class="intro-neon-inner"></div>
    <div class="intro-logo-img">
      <img src="logo.png" alt="Nepean School logo" />
    </div>
  </div>

  <div class="intro-text-bottom">
    <span id="introBottomText"></span><span class="intro-typed-cursor" id="introBottomCursor" style="display:none;"></span>
  </div>

  <div class="intro-click-hint" id="introClickHint">‚ñ≤ tap the logo to enter ‚ñ≤</div>
</div>

<!-- Audio for hero welcome -->
<audio id="heroAudio" preload="auto">
  <source src="hero.mp3" type="audio/mpeg">
</audio>

<!-- ===================== LANDING PAGE ===================== -->
<div id="landing" class="hidden">
  <div class="landing-content">

    <!-- Character placeholder -->
    <div class="landing-character" id="landingCharacter">
      <img src="hero.png" alt="Welcome character" />
    </div>

    <!-- Speech bubble with typing effect -->
    <div class="landing-bubble-wrap">
      <div class="landing-bubble">
        <span id="typedText"></span><span class="typing-cursor" id="typingCursor"></span>
        <span class="bubble-time" id="bubbleTime" style="display:none;">now</span>
      </div>
    </div>

    <!-- Enter button (appears after typing finishes) -->
    <button class="landing-enter-btn" id="enterBtn" style="opacity:0;pointer-events:none;" onclick="enterApp()">
      Let's Go ‚ûú
    </button>

  </div>
</div>

<!-- ===================== TABLE OF CONTENTS / SPLASH ===================== -->
<div id="splash" style="display:none;">
  <div class="splash-title-row">
    <span class="school-word">Nepean</span>
    <div class="logo-icon">üõ°Ô∏è</div>
    <span class="school-word">School</span>
  </div>
  <h1>WhatsApp Group Chat Safety</h1>


  <div class="name-input-bar">
    <label for="studentNameInput">üë§ My Name:</label>
    <input type="text" id="studentNameInput" placeholder="Enter your name here‚Ä¶" maxlength="60" autocomplete="name" />
  </div>

  <div class="toc-grid" id="tocGrid">
    <!-- JS fills this -->
  </div>
</div>

<!-- ===================== SIMULATION CONTAINER ===================== -->
<div id="sim-container">

  <!-- HEADER -->
  <div class="sim-header">
    <button class="back-btn" onclick="goHome()" aria-label="Back to menu">‚óÄ</button>
    <div class="group-avatar" id="groupAvatar">üë•</div>
    <div class="group-info">
      <div class="group-name" id="groupName">Group Name</div>
      <div class="group-members" id="groupMembers">Members</div>
    </div>
    <button class="safety-btn" id="safetyBtn" onclick="toggleHelp()" aria-label="Open safety help">üõ°Ô∏è</button>
  </div>

  <!-- SCORE BAR -->
  <div class="score-bar">
    <span class="stars" id="starsDisplay">‚≠ê 0</span>
    <span class="step-indicator" id="stepIndicator">Step 1 of 5</span>
  </div>

  <!-- ACCESSIBILITY TOGGLES -->
  <div class="a11y-bar">
    <button class="a11y-btn" onclick="toggleA11y('read-aloud')" id="btnReadAloud">üîä Read Aloud</button>
    <button class="a11y-btn" onclick="toggleA11y('easy-read')" id="btnEasyRead">üìñ Easy Read</button>
    <button class="a11y-btn" onclick="toggleA11y('hint')" id="btnHint">üí° Hint</button>
    <button class="a11y-btn" onclick="toggleA11y('reduce-clutter')" id="btnClutter">üßπ Less Clutter</button>
  </div>

  <!-- CHAT AREA -->
  <div class="chat-area" id="chatArea">
    <!-- JS fills chat bubbles -->
  </div>

  <!-- FEEDBACK PANEL -->
  <div class="feedback-panel" id="feedbackPanel">
    <h4 id="feedbackTitle"></h4>
    <p id="feedbackText"></p>
    <button class="next-btn" id="feedbackNext" onclick="nextStep()">Continue ‚ûú</button>
    <button class="retry-btn" id="feedbackRetry" onclick="retryStep()" style="display:none;">Try Again ‚Ü∫</button>
  </div>

  <!-- ACTION BAR -->
  <div class="action-bar" id="actionBar">
    <!-- JS fills buttons -->
  </div>

  <!-- DEBRIEF CARD -->
  <div class="debrief-card" id="debriefCard">
    <h3>üìã What Did We Learn?</h3>
    <div id="debriefContent"></div>
    <div class="finish-btns">
      <button class="finish-btn secondary" onclick="restartLesson()">‚Ü∫ Try Again</button>
      <button class="finish-btn secondary" onclick="startPractice()">üìù Practice</button>
      <button class="finish-btn primary" onclick="goHome()">üè† Menu</button>
    </div>
  </div>

  <!-- PRACTICE CONTAINER -->
  <div class="practice-container" id="practiceContainer"></div>
</div>

<!-- ===================== HELP PANEL (OVERLAY) ===================== -->
<div class="help-overlay" id="helpOverlay" onclick="toggleHelp()"></div>
<div class="help-panel" id="helpPanel">
  <button class="close-help" onclick="toggleHelp()">‚úï</button>
  <h3>üõ°Ô∏è Safety Help</h3>
  <p style="font-size:0.88rem; color:#666; margin-bottom:10px;">If something feels wrong, follow these steps:</p>
  <ol class="help-steps">
    <li data-step="1"><strong>Pause and think.</strong> Don't react straight away. Take a breath.</li>
    <li data-step="2"><strong>Check your feelings.</strong> Does this make you feel unsafe, uncomfortable or worried?</li>
    <li data-step="3"><strong>Choose a safe action.</strong> You can leave the chat, block someone, report a message or tell a trusted adult.</li>
  </ol>
  <button class="trusted-adult-btn" onclick="toggleTrusted()">üë§ Talk to a Trusted Adult</button>
  <div class="trusted-contacts" id="trustedContacts">
    <div class="tc-item">
      <span class="tc-icon">üë®‚Äçüë©‚Äçüëß</span>
      <div><span class="tc-name">Parent or carer</span><br><span class="tc-desc">Talk to someone at home you trust.</span></div>
    </div>
    <div class="tc-item">
      <span class="tc-icon">üßë‚Äçüè´</span>
      <div><span class="tc-name">Teacher</span><br><span class="tc-desc">Your class teacher or class ES.</span></div>
    </div>
    <div class="tc-item">
      <span class="tc-icon">üíö</span>
      <div><span class="tc-name">Nepean School Wellbeing Team</span><br><span class="tc-desc">Sarah Bylart</span></div>
    </div>
  </div>
</div>

<script>
// ============================================================
// DATA: All 22 lessons
// ============================================================
const LESSONS = [
  {
    id: 1,
    title: '"It\'s Just a \'Funny\' Video"',
    tag: "Harmful Content",
    groupName: "Friends Weekend üéâ",
    members: "You, Alex, Sam, Jordan, Taylor, Riley",
    avatar: "üé¨",
    goals: [
      "I can recognise when a video is inappropriate and not join in sharing it.",
      "I can speak up or quietly support someone who feels uncomfortable.",
      "I can block, report or leave the chat when harmful content continues."
    ],
    steps: [
      {
        chat: [
          { sender: "Alex", text: "OMG you guys NEED to see this üòÇüòÇ", time: "3:42 pm" },
          { sender: "Alex", type: "video", caption: "This is hilarious üòÇ", fwd: "Forwarded many times", time: "3:42 pm" },
          { sender: "Jordan", text: "LOL ü§£ü§£ü§£", time: "3:43 pm" },
          { sender: "Taylor", text: "hahaha send it to everyone", time: "3:43 pm" },
          { sender: "Sam", text: "üò¨", time: "3:44 pm" },
          { sender: "Riley", text: "It's just a joke; don't be uptight.", time: "3:44 pm" }
        ],
        actions: [
          { label: "‚ñ∂Ô∏è Play video", type: "bad", feedback: { title: "‚ö†Ô∏è Be Careful!", text: "The video contains offensive content that could hurt people. A 'forwarded many times' label is a red flag ‚Äî it means many people have already spread it. Watching and reacting encourages more sharing. Next time, pause before clicking.", mood: "bad" }},
          { label: "üö´ Don't watch", type: "good", feedback: { title: "üëç Good choice!", text: "You didn't watch or share the video. The 'forwarded many times' label was a red flag. Pausing before clicking is a smart habit. You can always ask what the video shows before deciding.", mood: "good" }},
          { label: "‚ùì Ask if it's ok", type: "good", feedback: { title: "üëç Smart thinking!", text: "Asking questions shows you think before you act. It also gives others like Sam a chance to say how they feel. Checking in with the group can change the whole conversation.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Look at the 'Forwarded many times' label and Sam's reaction. What do they tell you?"
      },
      {
        chat: [
          { sender: "Jordan", text: "Don't ruin the vibe üòí", time: "3:45 pm" },
          { sender: "Taylor", text: "yeah chill out, it's not that deep", time: "3:45 pm" },
          { type: "system", text: "Sam seems quiet and uncomfortable." }
        ],
        actions: [
          { label: "üí¨ Say it's not ok", type: "good", feedback: { title: "üåü Brave choice!", text: "Speaking up in a group takes courage. Research shows that when one person says something, others feel safer to agree. You could say: 'I don't think that's funny ‚Äî let's talk about something else.' You've helped Sam and anyone else who felt the same way.", mood: "good" }},
          { label: "üò∂ Ignore it", type: "caution", feedback: { title: "ü§î Think about this‚Ä¶", text: "Ignoring harmful content can feel like agreeing with it. Sam is uncomfortable and might feel alone. You don't have to make a big speech ‚Äî even a small message can help. Next time, consider reaching out privately.", mood: "caution" }},
          { label: "üì± Message Sam privately", type: "good", feedback: { title: "üëç Kind move!", text: "Sending Sam a private message like 'Are you ok? I didn't think that was funny either' shows support without putting yourself in the spotlight. Bystander support ‚Äî even quiet support ‚Äî matters a lot.", mood: "good" }}
        ],
        hint: "Being an upstander doesn't always mean speaking to the whole group. Think about private support too."
      },
      {
        chat: [
          { sender: "Alex", text: "I'm going to send it again since some people missed it üôÑ", time: "3:47 pm" },
          { type: "system", text: "Alex is about to reshare the harmful video." }
        ],
        actions: [
          { label: "üö© Report video", type: "good", feedback: { title: "‚úÖ Excellent!", text: "Reporting tells WhatsApp that this content breaks the rules. Reports are private ‚Äî no one in the group knows you did it. WhatsApp may remove the content or ban the sender.", mood: "good" }},
          { label: "üö´ Block sender", type: "good", feedback: { title: "‚úÖ Good move!", text: "Blocking Alex means you won't see their messages anymore. Remember: blocking stops messages coming to you, but it doesn't remove Alex from the group or delete them from your phone contacts.", mood: "good" }},
          { label: "üö™ Leave group", type: "good", feedback: { title: "‚úÖ That's okay!", text: "Leaving a group where harmful content is shared is always a valid choice. You can explain why later if you want, or just go. Your safety and comfort come first.", mood: "good" }},
          { label: "üë§ Tell trusted adult", type: "good", feedback: { title: "üåü Best choice!", text: "Telling a parent, carer or teacher means an adult can help sort this out properly. They can help you report the video and support anyone who was hurt by it. You're never 'dobbing' ‚Äî you're being responsible.", mood: "good" }}
        ],
        hint: "All the safe actions are good here. Think about which one you'd feel most comfortable doing."
      }
    ],
    debrief: {
      happened: "A forwarded video with offensive content was shared in your group chat. Peer pressure made it seem normal, but one friend (Sam) was clearly uncomfortable.",
      matters: "Harmful content isn't funny ‚Äî it can hurt real people and break school rules. Forwarding it makes you part of the problem. The 'forwarded many times' label is a warning sign.",
      nextTime: "Pause before you click. Check the forwarded label. Support anyone who looks uncomfortable. Use WhatsApp's report, block, and leave tools. Always tell a trusted adult if something makes you feel unsafe or pressured."
    },
    practice: [
      { q: "You see a video labelled 'Forwarded many times' in a group chat. What should you do first?", opts: ["Watch it to check if it's bad", "Pause and think before clicking", "Forward it to another group", "Ignore everything"], correct: 1, explain: "The 'Forwarded many times' label is a red flag. Always pause and think before watching or sharing." },
      { q: "Sam sends a üò¨ emoji after a video is shared. What might this mean?", opts: ["Sam thinks it's funny", "Sam is uncomfortable or worried", "Sam wants to watch it again", "Sam doesn't care"], correct: 1, explain: "A üò¨ often shows discomfort. Being aware of how others react helps you be a good friend." },
      { q: "Someone says 'Don't ruin the vibe' when you question a video. What is this an example of?", opts: ["Good advice", "Peer pressure", "A compliment", "A joke"], correct: 1, explain: "Telling someone not to speak up is peer pressure. It's okay to stand your ground when something isn't right." },
      { q: "What is the best way to support a friend who seems uncomfortable in a group chat?", opts: ["Tell them to toughen up", "Send them a private message of support", "Ignore them", "Leave the group without saying anything"], correct: 1, explain: "A private message like 'Are you ok?' shows you care and gives quiet support without putting anyone on the spot." },
      { q: "If you report a message on WhatsApp, who finds out?", opts: ["Everyone in the group", "Only the person you reported", "No one in the group ‚Äì reports are private", "Your teacher"], correct: 2, explain: "WhatsApp reports are private. No one in the chat will know you made the report." },
      { q: "What happens when you block someone on WhatsApp?", opts: ["They are deleted from your phone", "Their old messages disappear", "You stop receiving their messages", "They get a notification saying you blocked them"], correct: 2, explain: "Blocking stops new messages from that person. It doesn't delete them from your contacts or remove old messages." },
      { q: "You leave a group where harmful content is being shared. Is this okay?", opts: ["No, it's rude to leave", "Yes, your safety comes first", "Only if you tell everyone why", "No, you should stay and argue"], correct: 1, explain: "Leaving a group to protect yourself is always a valid choice. Your safety and comfort come first." },
      { q: "A friend asks you to forward a video 'for laughs'. You feel unsure. What should you do?", opts: ["Forward it ‚Äî they asked nicely", "Say no and explain you don't want to spread it", "Forward it then delete your copy", "Ask someone else to forward it instead"], correct: 1, explain: "If you feel unsure, trust your gut. You can say no ‚Äî a good friend will understand." },
      { q: "Why is telling a trusted adult about harmful content NOT 'snitching'?", opts: ["Because adults like gossip", "Because it helps protect you and others from harm", "Because you get a reward", "It is snitching and you shouldn't do it"], correct: 1, explain: "Telling a trusted adult helps keep everyone safe. It's being responsible, not snitching." },
      { q: "What are THREE safe actions you can take if harmful content is shared in your group chat?", opts: ["Watch, laugh, forward", "Report, block, tell a trusted adult", "Delete the app, buy a new phone, ignore", "Screenshot and post on social media"], correct: 1, explain: "Report the content, block the sender if needed, and tell a trusted adult. These three steps keep you and others safe." }
    ]
  },
  { id: 2, title: "Forwarded Without Consent", tag: "Consent", groupName: "Year 6 Squad üìö", members: "You, Mia, Liam, Priya, Noah, Zara", avatar: "üì®",
    goals: ["I can understand why forwarding someone's messages without asking is wrong.", "I can ask before sharing someone else's content.", "I can support someone whose messages were shared without permission."],
    steps: [
      { chat: [
          { sender: "Mia", text: "Look what Priya sent me privately üëÄ", time: "4:10 pm" },
          { sender: "Mia", text: "She said she has a crush on someone in our class!!", fwd: "Forwarded", time: "4:10 pm" },
          { sender: "Liam", text: "OMG WHO üò±", time: "4:11 pm" },
          { sender: "Noah", text: "spill the tea ‚òï", time: "4:11 pm" },
          { type: "system", text: "Priya is not in this group and doesn't know her message was shared." }
        ],
        actions: [
          { label: "üòÇ Ask who the crush is", type: "bad", feedback: { title: "‚ö†Ô∏è Think again!", text: "Priya shared that message privately with Mia. Joining in spreads private information further without Priya's consent. How would you feel if your private messages were shared?", mood: "bad" }},
          { label: "‚úã Say this isn't ok", type: "good", feedback: { title: "üëç Great choice!", text: "Telling the group that Priya's private message shouldn't have been shared shows respect for consent. You could say: 'That was private ‚Äî we shouldn't be reading it.'", mood: "good" }},
          { label: "üì± Tell Priya what happened", type: "good", feedback: { title: "üëç Kind and honest!", text: "Letting Priya know her message was shared gives her the chance to take action. She might want to talk to Mia or get adult help.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Priya doesn't know her private message was forwarded. Think about consent."
      },
      { chat: [
          { sender: "Mia", text: "Relax it's not a big deal üôÑ", time: "4:13 pm" },
          { sender: "Zara", text: "Actually it kind of is... Priya told you that in private", time: "4:13 pm" }
        ],
        actions: [
          { label: "üí¨ Agree with Zara", type: "good", feedback: { title: "üëç Supporting Zara!", text: "When someone stands up and you back them, it makes the message stronger. Zara is right ‚Äî private messages should stay private.", mood: "good" }},
          { label: "üö™ Leave the conversation", type: "caution", feedback: { title: "ü§î That's okay but‚Ä¶", text: "Leaving removes you from the situation, which is fine. But consider first supporting Priya or Zara before you go.", mood: "caution" }},
          { label: "üë§ Tell a trusted adult", type: "good", feedback: { title: "‚úÖ Responsible choice!", text: "If private information is being spread around, an adult can help sort it out and support Priya.", mood: "good" }}
        ],
        hint: "Zara is being an upstander. Can you support her?"
      }
    ],
    debrief: { happened: "Mia forwarded Priya's private message to the group without permission. Others wanted to gossip about it.", matters: "Everyone has a right to privacy. Forwarding private messages without consent can damage trust and friendships, and may be cyberbullying.", nextTime: "Always ask before sharing someone else's messages. If you see someone's private info being shared, speak up or let them know. Tell a trusted adult if the situation feels serious." },
    practice: [
      { q: "Mia forwards Priya's private message to a group. What has Mia done wrong?", opts: ["Nothing ‚Äî friends share everything", "Shared Priya's private information without consent", "Made a joke", "Helped Priya"], correct: 1, explain: "Forwarding private messages without permission breaks trust and violates Priya's consent." },
      { q: "What does 'consent' mean in messaging?", opts: ["Sending messages quickly", "Getting permission before sharing someone's content", "Reading all messages in a group", "Forwarding everything you receive"], correct: 1, explain: "Consent means asking and receiving permission before sharing someone else's messages or information." },
      { q: "How would you feel if a private message you sent was forwarded without your knowledge?", opts: ["Happy ‚Äî more people saw it", "Betrayed and upset", "It wouldn't matter", "Excited"], correct: 1, explain: "Most people would feel hurt or betrayed. This is why we need to respect others' privacy." },
      { q: "What's the best thing to say in the group when private info is shared?", opts: ["Tell me more!", "That was private ‚Äî we shouldn't be reading it", "Screenshot it before it's deleted", "LOL"], correct: 1, explain: "Calling it out respectfully reminds everyone about the importance of privacy and consent." },
      { q: "Should you tell Priya that her message was forwarded?", opts: ["No ‚Äî it would upset her", "Yes ‚Äî she has a right to know", "Only if you think it's funny", "No ‚Äî it's none of your business"], correct: 1, explain: "Priya has a right to know so she can decide what to do next, including talking to Mia or getting adult help." },
      { q: "Before forwarding a friend's message, you should always‚Ä¶", opts: ["Add emojis to it", "Ask them if it's okay to share", "Forward it quickly before they notice", "Delete the original"], correct: 1, explain: "Always ask permission. A simple 'Can I share this?' respects their privacy." },
      { q: "What might happen if private messages keep being shared in a friendship group?", opts: ["Everyone gets closer", "Trust breaks down and people feel unsafe", "Nothing changes", "More people join the group"], correct: 1, explain: "When privacy isn't respected, trust disappears and people stop feeling safe sharing anything." },
      { q: "Zara speaks up and says forwarding was wrong. What should you do?", opts: ["Tell Zara to mind her own business", "Support Zara ‚Äî she's right", "Laugh at Zara", "Leave without saying anything"], correct: 1, explain: "Supporting someone who stands up for what's right gives them courage and sends a message to the group." },
      { q: "A trusted adult can help by‚Ä¶", opts: ["Punishing everyone", "Supporting Priya and helping resolve the situation safely", "Ignoring it", "Sharing the message themselves"], correct: 1, explain: "Trusted adults can mediate, support those affected, and help prevent it from happening again." },
      { q: "True or false: If a message has no 'forwarded' label, it's okay to share it.", opts: ["True", "False ‚Äî you still need consent"], correct: 1, explain: "The forwarded label doesn't determine whether sharing is okay. You always need the sender's permission." }
    ]
  },
  { id: 3, title: '"Don\'t Be a Snitch" Pressure', tag: "Peer Pressure", groupName: "After School Chat üè´", members: "You, Dylan, Harper, Kai, Ava, Oscar", avatar: "ü§´",
    goals: ["I can recognise when someone is pressuring me to stay quiet.", "I can understand the difference between 'snitching' and keeping people safe.", "I can tell a trusted adult even when others say I shouldn't."],
    steps: [
      { chat: [
          { sender: "Dylan", text: "Did you see what happened to Marcus at lunch?", time: "4:30 pm" },
          { sender: "Harper", text: "Yeah that was messed up üòû", time: "4:30 pm" },
          { sender: "Kai", text: "Don't tell anyone. Snitches get stitches ü§ê", time: "4:31 pm" },
          { sender: "Ava", text: "Fr just keep it in the group", time: "4:31 pm" },
          { type: "system", text: "Something happened to Marcus and you feel worried about him." }
        ],
        actions: [
          { label: "ü§ê Stay quiet", type: "bad", feedback: { title: "‚ö†Ô∏è Think about Marcus", text: "Staying quiet might feel safe for you, but Marcus might need help. 'Don't snitch' is peer pressure designed to protect the person who did wrong ‚Äî not the person who was hurt.", mood: "bad" }},
          { label: "üí¨ Say Marcus needs help", type: "good", feedback: { title: "üëç Brave and kind!", text: "You're putting Marcus's safety first. You could say: 'I think someone should check on Marcus ‚Äî that wasn't okay.' Speaking up can start a chain of help.", mood: "good" }},
          { label: "üë§ Tell a trusted adult", type: "good", feedback: { title: "üåü Absolutely right!", text: "Telling a trusted adult isn't snitching ‚Äî it's keeping someone safe. Adults can check on Marcus and deal with the situation properly.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Think about the difference between 'snitching' and protecting someone who might be hurt."
      },
      { chat: [
          { sender: "Kai", text: "If anyone tells a teacher you're dead to us üíÄ", time: "4:33 pm" },
          { sender: "Oscar", text: "That's a bit harsh Kai...", time: "4:33 pm" }
        ],
        actions: [
          { label: "üí™ Support Oscar", type: "good", feedback: { title: "üëç Strength in numbers!", text: "Oscar is pushing back against Kai's threat. Supporting him shows the group that intimidation isn't okay. You could say: 'Oscar's right ‚Äî threatening people isn't cool.'", mood: "good" }},
          { label: "üì± Screenshot and report", type: "good", feedback: { title: "‚úÖ Good thinking!", text: "Kai's message is a threat. Keeping a screenshot as evidence and showing a trusted adult helps protect you and Marcus. Threats are never acceptable.", mood: "good" }},
          { label: "üò∂ Say nothing", type: "caution", feedback: { title: "ü§î Understandable but‚Ä¶", text: "It can feel scary when someone threatens you. But silence can be seen as agreement. If you're afraid, talk to a trusted adult privately ‚Äî they can help without putting you at risk.", mood: "caution" }}
        ],
        hint: "Kai is using threats to stop people from doing the right thing. That's not okay."
      }
    ],
    debrief: { happened: "Something happened to Marcus and the group tried to pressure everyone into silence using 'snitch' language and threats.", matters: "Telling a trusted adult when someone is hurt is never snitching ‚Äî it's keeping people safe. Threats to stay quiet are a form of bullying.", nextTime: "If someone says 'don't snitch', ask yourself: who does staying quiet protect? If it protects the person who did wrong (not the person who was hurt), then speaking up is the right thing. Tell a trusted adult privately if you feel threatened." },
    practice: [
      { q: "'Snitches get stitches' is an example of‚Ä¶", opts: ["Good advice", "Peer pressure to stay silent", "A funny saying", "School rules"], correct: 1, explain: "It's peer pressure designed to stop you from telling adults who can help." },
      { q: "What's the difference between 'snitching' and reporting?", opts: ["There's no difference", "Snitching is to get someone in trouble; reporting is to keep someone safe", "Reporting is worse", "They're both wrong"], correct: 1, explain: "Reporting is about protecting someone from harm. It's a responsible and caring action." },
      { q: "Kai threatens that anyone who tells a teacher is 'dead to us'. This is‚Ä¶", opts: ["A joke", "Intimidation/bullying", "Good leadership", "Team spirit"], correct: 1, explain: "Using threats to control others is a form of bullying and intimidation." },
      { q: "If you feel too scared to speak up in the group, what can you do?", opts: ["Just forget about it", "Tell a trusted adult privately", "Agree with Kai", "Delete the chat"], correct: 1, explain: "Speaking to a trusted adult privately keeps you safe while still getting help for Marcus." },
      { q: "Who does 'don't tell anyone' usually protect?", opts: ["The person who was hurt", "The person who did something wrong", "Everyone equally", "The teachers"], correct: 1, explain: "The code of silence protects the wrongdoer, not the victim." },
      { q: "Oscar pushes back against Kai. How can you help?", opts: ["Tell Oscar to be quiet too", "Support Oscar's message", "Leave the chat immediately", "Change the subject"], correct: 1, explain: "Supporting someone who speaks up gives them courage and shows the group that kindness wins." },
      { q: "Is it okay to screenshot threatening messages?", opts: ["No ‚Äî that's snitching", "Yes ‚Äî it's evidence that can help adults understand what happened", "Only if the person says it's ok", "Never ‚Äî just delete them"], correct: 1, explain: "Screenshots are important evidence that can help trusted adults take appropriate action." },
      { q: "A trusted adult's job when you report something is to‚Ä¶", opts: ["Get you in trouble", "Ignore it", "Help keep everyone safe and deal with the situation", "Tell the whole school"], correct: 2, explain: "Trusted adults are there to help, support, and resolve situations safely." },
      { q: "Marcus was hurt. Staying quiet means‚Ä¶", opts: ["You're being a good friend to everyone", "Marcus might not get the help he needs", "Everything will sort itself out", "Marcus will appreciate it"], correct: 1, explain: "Silence can leave someone suffering alone. Speaking up gets them the support they deserve." },
      { q: "True or false: It's only worth reporting if someone is physically hurt.", opts: ["True", "False ‚Äî emotional harm matters too"], correct: 1, explain: "Emotional harm, threats, and exclusion are all serious and worth reporting." }
    ]
  }
];

// Lessons 4‚Äì22: Skeleton data (we'll add full steps in continuation)
const LESSON_SKELETONS = [
  { id: 4, title: "Bystander Freeze", tag: "Bystander", avatar: "üßä" },
  { id: 5, title: "Dogpiling in the Group Chat", tag: "Cyberbullying", avatar: "üê∫" },
  { id: 6, title: "Screenshots Shared Outside the Group", tag: "Privacy", avatar: "üì∏" },
  { id: 7, title: 'Private Information Leaked ("Doxxing‚Äëlite")', tag: "Privacy", avatar: "üîì" },
  { id: 8, title: "Fake Profile / Impersonation", tag: "Identity", avatar: "üé≠" },
  { id: 9, title: "Added to a Random Group", tag: "Safety", avatar: "‚ûï" },
  { id: 10, title: '"Click This Link Now" Urgency', tag: "Scams", avatar: "üîó" },
  { id: 11, title: "Verification Code Trap", tag: "Scams", avatar: "üî¢" },
  { id: 12, title: '"Free Prize / Free Vouchers" Scam', tag: "Scams", avatar: "üéÅ" },
  { id: 13, title: 'Account Takeover = Messages From "You"', tag: "Security", avatar: "üëª" },
  { id: 14, title: "Unwanted Contact / Grooming Red Flags", tag: "Safety", avatar: "üö©" },
  { id: 15, title: 'Threats and Blackmail ("If you don\'t‚Ä¶")', tag: "Safety", avatar: "‚ö†Ô∏è" },
  { id: 16, title: '"Delete It, It Disappears" Myth', tag: "Digital Footprint", avatar: "üí®" },
  { id: 17, title: "Pressure to Send Photos", tag: "Safety", avatar: "üì∑" },
  { id: 18, title: "Hate Speech / Targeting Identity", tag: "Inclusion", avatar: "üè≥Ô∏è‚Äçüåà" },
  { id: 19, title: "Rumours Spread Fast", tag: "Kindness", avatar: "üó£Ô∏è" },
  { id: 20, title: "Location Sharing Risks", tag: "Privacy", avatar: "üìç" },
  { id: 21, title: "Who Can See My Info? (Privacy Settings)", tag: "Privacy", avatar: "üëÅÔ∏è" },
  { id: 22, title: '"School Stuff" vs "After Hours"', tag: "Boundaries", avatar: "üïê" }
];

// Fill in lessons 4-22 with full content
// LESSON 4: Bystander Freeze
LESSONS.push({
  id: 4, title: "Bystander Freeze", tag: "Bystander",
  groupName: "Our Class üè´", members: "You, Ella, Marcus, Ben, Chloe, Aisha", avatar: "üßä",
  goals: ["I can recognise when I 'freeze' and don't act in a group chat.", "I can understand why doing nothing can allow harm to continue.", "I can take small steps to help, even when I feel unsure."],
  steps: [
    { chat: [
        { sender: "Ben", text: "Has anyone seen Chloe's haircut? üíÄüíÄ", time: "5:01 pm" },
        { sender: "Ella", text: "Omg stop üòÇ", time: "5:01 pm" },
        { sender: "Marcus", text: "She looks like a coconut ü••üòÇ", time: "5:02 pm" },
        { type: "system", text: "Chloe is in this group and can see these messages. She hasn't replied." },
        { sender: "Aisha", text: "...", time: "5:03 pm" }
      ],
      actions: [
        { label: "üòÇ Join in laughing", type: "bad", feedback: { title: "‚ö†Ô∏è That hurts!", text: "Joining in makes the bullying worse. Chloe can see everything. Even adding a laughing emoji counts as piling on. Think about how you'd feel reading those messages about yourself.", mood: "bad" }},
        { label: "üò∂ Do nothing", type: "caution", feedback: { title: "ü§î Freezing is common but‚Ä¶", text: "It's normal to freeze when you don't know what to do. But silence in a group chat can feel like agreement to the person being targeted. Even a small action helps ‚Äî you don't have to make a speech.", mood: "caution" }},
        { label: "üí¨ Say something kind", type: "good", feedback: { title: "üëç Wonderful!", text: "Even a simple message like 'That's not cool, leave Chloe alone' or 'I think her hair looks nice' can change the whole mood. One person breaking the silence gives others permission to be kind too.", mood: "good" }},
        { label: "üì± Message Chloe privately", type: "good", feedback: { title: "üëç Thoughtful!", text: "A private message like 'Hey, ignore them ‚Äî I think you look great' can mean the world to Chloe. You don't have to be loud to be kind.", mood: "good" }}
      ],
      hint: "Chloe can see all of this. She's probably feeling terrible. What would you want someone to do if it was about you?"
    },
    { chat: [
        { sender: "Ben", text: "Why is everyone so quiet lol", time: "5:05 pm" },
        { sender: "Marcus", text: "It's just banter chill", time: "5:05 pm" }
      ],
      actions: [
        { label: "üö© Report the messages", type: "good", feedback: { title: "‚úÖ Taking action!", text: "Reporting mean messages helps keep the group safe. You can also show a teacher or trusted adult what's been said.", mood: "good" }},
        { label: "üí¨ Say 'It's not banter if someone's hurt'", type: "good", feedback: { title: "üåü Powerful words!", text: "Calling out the difference between banter and bullying helps everyone understand. If the person being talked about isn't laughing, it's not a joke.", mood: "good" }},
        { label: "üë§ Tell a trusted adult", type: "good", feedback: { title: "‚úÖ Always a good choice!", text: "An adult can step in to support Chloe and address the behaviour. You're helping by taking responsibility.", mood: "good" }}
      ],
      hint: "If the person being talked about isn't laughing, it's not banter ‚Äî it's bullying."
    }
  ],
  debrief: { happened: "Group members made fun of Chloe's appearance in a chat she could see. Most people froze and didn't respond.", matters: "The 'bystander freeze' is when you see something wrong but don't act. In group chats, silence can feel like agreement. One kind word can break the cycle.", nextTime: "You don't have to be loud to help. A private message of support, a kind word in the group, or telling a trusted adult are all ways to break the freeze." },
  practice: [
    { q: "What is 'bystander freeze'?", opts: ["When you join in with bullying", "When you see something wrong but don't act", "When you leave the chat", "When you report a message"], correct: 1, explain: "Bystander freeze is when you witness harm but feel stuck and don't respond." },
    { q: "In a group chat, staying silent when someone is being teased can feel like‚Ä¶", opts: ["Supporting the person being teased", "Agreement with the teasing", "Being neutral", "Being invisible"], correct: 1, explain: "Silence in a public space like a group chat can be interpreted as going along with the bullying." },
    { q: "What's a small action you can take to help someone being bullied?", opts: ["Add more jokes", "Send a private message of support", "Leave and don't think about it", "Delete the app"], correct: 1, explain: "A private message shows care and support without needing to be confrontational." },
    { q: "'It's just banter' ‚Äî how do you know if it's actually bullying?", opts: ["If everyone's laughing, it's fine", "If the person being targeted isn't laughing, it's bullying", "Banter and bullying are the same thing", "It's only bullying if a teacher says so"], correct: 1, explain: "The key test: is the person being talked about happy or hurt? If they're hurt, it's not banter." },
    { q: "Why does one person speaking up make such a big difference?", opts: ["It doesn't really help", "It gives others permission to be kind too", "It makes things worse", "It only helps if a teacher sees"], correct: 1, explain: "Research shows that when one person breaks the silence, others feel braver to support them." },
    { q: "Chloe hasn't replied to the mean messages. This probably means‚Ä¶", opts: ["She thinks it's funny", "She's busy with homework", "She feels hurt or embarrassed", "She didn't see them"], correct: 2, explain: "Silence from the person being targeted often signals hurt, embarrassment, or not knowing what to say." },
    { q: "What could you say in the group to help?", opts: ["'LOL good one'", "'That's not cool ‚Äî leave Chloe alone'", "'Who cares'", "'Send a photo of the haircut'"], correct: 1, explain: "A clear, kind message calling out the behaviour can change the whole tone of the conversation." },
    { q: "Is reporting mean messages in a group chat the right thing to do?", opts: ["No ‚Äî it's just words", "Yes ‚Äî mean messages can be cyberbullying and should be reported", "Only if there are swear words", "Only if a teacher asks you to"], correct: 1, explain: "Repeated mean comments are cyberbullying. Reporting helps protect the person being targeted." },
    { q: "You feel nervous about speaking up. What can you do?", opts: ["Just stay quiet forever", "Talk to a trusted adult who can help", "Pretend you didn't see it", "Wait for someone else to do something"], correct: 1, explain: "If speaking up in the group feels too hard, telling a trusted adult is a strong and safe alternative." },
    { q: "True or false: You have to make a big speech to help someone being bullied.", opts: ["True ‚Äî only big actions count", "False ‚Äî even small actions like a private message matter"], correct: 1, explain: "Small acts of kindness ‚Äî a private message, a kind emoji, a word of support ‚Äî all make a real difference." }
  ]
});

// LESSON 5: Dogpiling
LESSONS.push({
  id: 5, title: "Dogpiling in the Group Chat", tag: "Cyberbullying",
  groupName: "Sports Team üèÖ", members: "You, Jake, Lily, Raj, Emma, Will", avatar: "üê∫",
  goals: ["I can recognise when multiple people are ganging up on one person (dogpiling).", "I can refuse to join in even when it seems like everyone else is.", "I can take action to stop or report group bullying."],
  steps: [
    { chat: [
        { sender: "Jake", text: "Raj you were SO bad at the game today üòÇ", time: "5:20 pm" },
        { sender: "Lily", text: "honestly tho‚Ä¶ worst player on the team", time: "5:20 pm" },
        { sender: "Emma", text: "Maybe sit the next one out üíÄ", time: "5:21 pm" },
        { sender: "Will", text: "lol sorry Raj but it's true", time: "5:21 pm" },
        { type: "system", text: "Raj is typing but then stops. The messages keep coming." }
      ],
      actions: [
        { label: "üòÇ Add a comment too", type: "bad", feedback: { title: "‚ö†Ô∏è That's dogpiling!", text: "When multiple people pile on one person, it's called dogpiling. Each extra message makes it worse. Even 'gentle' teasing adds to the weight Raj is feeling.", mood: "bad" }},
        { label: "üõë Say 'That's enough'", type: "good", feedback: { title: "üåü Brave and important!", text: "Saying 'That's enough ‚Äî lay off Raj' can snap the group out of mob mentality. It takes courage, but it works. One voice can stop the pile-on.", mood: "good" }},
        { label: "üì± Message Raj privately", type: "good", feedback: { title: "üëç Kind move!", text: "A private message like 'Don't listen to them, you played fine' gives Raj support when they need it most. Private support is powerful.", mood: "good" }},
        { label: "üõ°Ô∏è Open help", type: "help" }
      ],
      hint: "Raj started typing but stopped. That's a sign they're overwhelmed. What would you want someone to do for you?"
    },
    { chat: [
        { sender: "Jake", text: "Can't even take a joke üôÑ", time: "5:23 pm" },
        { sender: "Raj", text: "Can you all just stop please", time: "5:24 pm" },
        { sender: "Lily", text: "Lol snowflake", time: "5:24 pm" }
      ],
      actions: [
        { label: "üí¨ Defend Raj publicly", type: "good", feedback: { title: "üåü Standing up!", text: "Raj asked them to stop and they didn't. Now it's clearly bullying. Saying 'Raj asked you to stop. Respect that.' is powerful and clear.", mood: "good" }},
        { label: "üö© Report the messages", type: "good", feedback: { title: "‚úÖ Good choice!", text: "When someone asks for it to stop and the group continues, that's harassment. Reporting the messages protects Raj.", mood: "good" }},
        { label: "üë§ Tell a trusted adult", type: "good", feedback: { title: "‚úÖ The right thing!", text: "This has gone beyond teasing into bullying. A trusted adult ‚Äî coach, teacher or parent ‚Äî can address this with the whole group.", mood: "good" }}
      ],
      hint: "Raj asked them to stop. When someone says stop and the group continues, that's bullying."
    }
  ],
  debrief: { happened: "Multiple group members targeted Raj about their sports performance. When Raj asked them to stop, the bullying continued.", matters: "Dogpiling is when many people gang up on one person. Each comment feels small to the sender but massive to the receiver. When someone says 'stop' and you don't, it's bullying.", nextTime: "Refuse to pile on, even if 'everyone else is doing it'. Speak up, support the person privately, and tell a trusted adult if someone asks for the bullying to stop and it continues." },
  practice: [
    { q: "What is 'dogpiling'?", opts: ["A fun group activity", "When multiple people gang up on one person online", "A sports term", "When a dog jumps on you"], correct: 1, explain: "Dogpiling is when several people target one person with negative comments at the same time." },
    { q: "Raj started typing but stopped. What might this mean?", opts: ["They're busy", "They feel overwhelmed and don't know what to say", "Their phone died", "They think it's funny"], correct: 1, explain: "Starting to type and stopping is often a sign someone feels overwhelmed or outnumbered." },
    { q: "When does teasing become bullying?", opts: ["Never ‚Äî it's always just fun", "When the person being teased is hurt or asks for it to stop", "Only if a teacher sees it", "Only if there are swear words"], correct: 1, explain: "When the person on the receiving end is hurt or asks for it to stop, teasing has crossed into bullying." },
    { q: "Lily calls Raj a 'snowflake' for asking them to stop. This is‚Ä¶", opts: ["A compliment", "Dismissing Raj's feelings and continuing the bullying", "Just a joke", "Helpful feedback"], correct: 1, explain: "Dismissing someone's feelings when they express hurt is a form of continued bullying." },
    { q: "What can one person saying 'That's enough' do to a dogpile?", opts: ["Nothing ‚Äî it won't help", "It can break the mob mentality and make others reconsider", "It makes things worse", "Only works if they're popular"], correct: 1, explain: "One voice of reason can snap others out of group behaviour and shift the conversation." },
    { q: "If you feel too nervous to speak up in the group, you can‚Ä¶", opts: ["Just laugh along", "Send Raj a private message of support", "Delete the app", "Pretend you didn't see it"], correct: 1, explain: "Private support is still powerful support. Let Raj know you're on their side." },
    { q: "Why should you report messages even if each one seems 'small'?", opts: ["You shouldn't ‚Äî they're just comments", "Because together, many small comments become a big attack", "Only report if there's swearing", "Only report if someone cries"], correct: 1, explain: "Each individual message might seem minor, but together they create a wall of negativity for the person targeted." },
    { q: "A coach or teacher can help by‚Ä¶", opts: ["Ignoring it", "Talking to the whole team about respect and addressing the behaviour", "Kicking Raj off the team", "Sending more mean messages"], correct: 1, explain: "Adults can address the group dynamic, support Raj, and set clear expectations about respectful behaviour." },
    { q: "True or false: If everyone else is doing it, joining in is okay.", opts: ["True ‚Äî majority rules", "False ‚Äî doing the wrong thing in a group is still wrong"], correct: 1, explain: "Just because others are doing something doesn't make it right. You always have a choice." },
    { q: "What three things can you do if you see dogpiling?", opts: ["Laugh, screenshot, share", "Speak up, support privately, tell an adult", "Ignore, forget, move on", "Join in, leave, delete"], correct: 1, explain: "Speak up if you can, send private support, and involve a trusted adult. These three actions make a real difference." }
  ]
});

// For lessons 6-22, we'll create the full content
// LESSON 6
LESSONS.push({
  id: 6, title: "Screenshots Shared Outside the Group", tag: "Privacy",
  groupName: "Besties Only üíï", members: "You, Zoe, Finn, Grace, Leo, Maya", avatar: "üì∏",
  goals: ["I can understand that screenshots can spread private conversations.", "I can think before I screenshot and share.", "I can speak up when screenshots are shared without consent."],
  steps: [
    { chat: [
        { sender: "Finn", text: "Did you see what Grace said in the other group? I screenshotted it üì∏", time: "6:10 pm" },
        { sender: "Finn", type: "image", caption: "Look at this üòÇ", time: "6:10 pm" },
        { sender: "Zoe", text: "OMG she actually said that?!", time: "6:11 pm" },
        { sender: "Leo", text: "Forward it to everyone lol", time: "6:11 pm" },
        { type: "system", text: "Grace doesn't know her messages from another group have been screenshotted and shared here." }
      ],
      actions: [
        { label: "üòÇ React and share", type: "bad", feedback: { title: "‚ö†Ô∏è Stop and think!", text: "Sharing someone's screenshots without permission spreads private content and can really hurt people. How would you feel if your messages were passed around?", mood: "bad" }},
        { label: "‚úã Say screenshots are private", type: "good", feedback: { title: "üëç Respectful choice!", text: "Reminding the group that screenshots of private conversations shouldn't be shared respects everyone's privacy. You could say: 'That was from a private chat ‚Äî we shouldn't be sharing it.'", mood: "good" }},
        { label: "üì± Tell Grace", type: "good", feedback: { title: "üëç Honest and kind!", text: "Grace deserves to know her messages are being shared. She can decide what to do about it.", mood: "good" }},
        { label: "üõ°Ô∏è Open help", type: "help" }
      ],
      hint: "Grace said something in a different, private group. How would you feel if someone screenshotted YOUR messages?"
    }
  ],
  debrief: { happened: "Finn screenshotted Grace's messages from another group and shared them without permission.", matters: "Screenshots can spread private conversations to people who were never meant to see them. This breaks trust and can be a form of cyberbullying.", nextTime: "Think before you screenshot. Ask yourself: would this person be okay with me sharing this? If in doubt, don't share it." },
  practice: [
    { q: "Finn screenshots Grace's messages from another group. This is wrong because‚Ä¶", opts: ["It's too much effort", "It shares private content without Grace's consent", "Screenshots are always illegal", "Grace won't care"], correct: 1, explain: "Sharing screenshots of private conversations without permission violates trust and consent." },
    { q: "Before taking a screenshot of a chat, you should ask‚Ä¶", opts: ["'Is this funny enough?'", "'Would this person be okay with me sharing this?'", "'Will I get more followers?'", "'Is my phone storage full?'"], correct: 1, explain: "Always consider whether the person whose words you're capturing would consent to them being shared." },
    { q: "What should you do if someone shares a screenshot of your private messages?", opts: ["Nothing ‚Äî it's already out there", "Tell them it's not okay and talk to a trusted adult", "Screenshot their messages in revenge", "Leave all your groups"], correct: 1, explain: "Let them know it's not okay and get help from a trusted adult who can support you." },
    { q: "True or false: If a message was sent in a group chat, anyone can screenshot and share it.", opts: ["True ‚Äî group chats are public", "False ‚Äî you still need consent to share someone's words"], correct: 1, explain: "Even in group chats, sharing someone's messages outside the group without consent is a breach of trust." },
    { q: "Leo says 'Forward it to everyone.' What should you do?", opts: ["Do what Leo says", "Refuse and explain why sharing it is wrong", "Forward it to just a few people", "Screenshot Leo's message too"], correct: 1, explain: "Spreading private content wider makes the problem worse. Refuse and explain why." },
    { q: "Grace doesn't know her messages were shared. Why is this especially harmful?", opts: ["It's not harmful if she doesn't know", "She can't defend herself or take action", "She probably won't care", "It only matters if she finds out"], correct: 1, explain: "Not knowing means Grace can't defend herself, correct misunderstandings, or seek help." },
    { q: "What might happen to the group's trust if screenshots are regularly shared?", opts: ["Nothing changes", "People stop feeling safe to share honestly", "The group gets more popular", "Everyone takes better screenshots"], correct: 1, explain: "When people fear their messages will be shared, they stop trusting the group and communicating openly." },
    { q: "A friend asks you to screenshot a conversation for them. You should‚Ä¶", opts: ["Do it immediately", "Ask why they need it and consider if it's appropriate", "Refuse without explanation", "Screenshot only the funny parts"], correct: 1, explain: "Understanding the reason and considering whether the people in the chat would consent helps you make a responsible choice." },
    { q: "Is it okay to screenshot messages if you need to show a trusted adult something concerning?", opts: ["No ‚Äî screenshots are always wrong", "Yes ‚Äî keeping evidence to show a trusted adult for safety reasons is responsible", "Only with a teacher's permission", "Only on weekends"], correct: 1, explain: "Keeping evidence to protect yourself or others and showing a trusted adult is responsible, not a breach of trust." },
    { q: "How can you be a good group chat member when it comes to screenshots?", opts: ["Screenshot everything for safety", "Don't take screenshots of private content without consent, and speak up if others do", "Never read any messages", "Leave every group"], correct: 1, explain: "Respecting privacy, thinking before screenshotting, and speaking up when others share without consent." }
  ]
});

// Continue with lessons 7-22 with full interactive content
LESSONS.push({
  id: 7, title: 'Private Information Leaked ("Doxxing‚Äëlite")', tag: "Privacy",
  groupName: "Neighbourhood Kids üè†", members: "You, Aiden, Sophie, Luca, Noor, Tess", avatar: "üîì",
  goals: ["I can recognise when private information like addresses or phone numbers is shared without permission.", "I can understand why sharing personal details is dangerous.", "I can report doxxing and support the person affected."],
  steps: [
    { chat: [
        { sender: "Aiden", text: "I found out where Sophie lives lol", time: "3:15 pm" },
        { sender: "Aiden", text: "It's [ADDRESS REDACTED] near the shops üìç", time: "3:15 pm" },
        { sender: "Luca", text: "Wait why are you posting that?", time: "3:16 pm" },
        { sender: "Tess", text: "That's her actual address??", time: "3:16 pm" },
        { type: "system", text: "Sophie's home address has been shared in the group without her permission." }
      ],
      actions: [
        { label: "üìç Save the address", type: "bad", feedback: { title: "üö® This is dangerous!", text: "Saving someone's address when it was shared without their consent is harmful. Sharing someone's private information (doxxing) can put them in real danger.", mood: "bad" }},
        { label: "üõë Tell Aiden to delete it", type: "good", feedback: { title: "üëç Quick thinking!", text: "Asking Aiden to delete the message immediately is the right first step. Personal information like addresses should never be shared without consent.", mood: "good" }},
        { label: "üë§ Tell a trusted adult NOW", type: "good", feedback: { title: "üåü Absolutely right!", text: "When real-world information like a home address is shared, this is serious. An adult needs to know immediately to protect Sophie and her family.", mood: "good" }},
        { label: "üõ°Ô∏è Open help", type: "help" }
      ],
      hint: "A home address is serious private information. This could put Sophie and her family at risk."
    }
  ],
  debrief: { happened: "Aiden shared Sophie's home address in the group chat without her permission.", matters: "Sharing private information like addresses, phone numbers, or school details (even 'light' doxxing) can put someone's physical safety at risk. It's never okay, even as a 'joke'.", nextTime: "Never share someone's private information. If you see it happen, ask for immediate deletion and tell a trusted adult. This is always urgent." },
  practice: [
    { q: "What is 'doxxing'?", opts: ["A type of game", "Sharing someone's private information publicly without consent", "Deleting messages", "A WhatsApp feature"], correct: 1, explain: "Doxxing means revealing someone's private details (address, phone, school) without their permission." },
    { q: "Why is sharing a home address dangerous?", opts: ["It's not dangerous", "Strangers could find and harm the person", "It's just embarrassing", "Only dangerous for adults"], correct: 1, explain: "A leaked address could lead to harassment, stalking, or other dangers for the person and their family." },
    { q: "Aiden says it's 'just a joke'. Is sharing an address ever a joke?", opts: ["Yes if it's funny", "No ‚Äî it's always serious and potentially dangerous", "Only if the person laughs", "Yes between close friends"], correct: 1, explain: "Private information being shared is never a joke. The consequences can be real and serious." },
    { q: "What should you do first if you see personal info shared in a chat?", opts: ["Screenshot and forward it", "Ask for it to be deleted immediately and tell a trusted adult", "Ignore it", "Save it just in case"], correct: 1, explain: "Immediate action ‚Äî requesting deletion and telling an adult ‚Äî is crucial to limit the spread." },
    { q: "Which of these counts as private information?", opts: ["A person's favourite colour", "Their home address, phone number, or school name", "Their favourite movie", "What they had for lunch"], correct: 1, explain: "Addresses, phone numbers, school names, and similar details are private and should never be shared without consent." },
    { q: "Luca asks 'Why are you posting that?' This shows‚Ä¶", opts: ["Luca is nosy", "Luca recognises something is wrong", "Luca wants the address too", "Luca doesn't care"], correct: 1, explain: "Luca's question shows they recognise that sharing private information is inappropriate." },
    { q: "If you accidentally see someone's private information in a chat, you should‚Ä¶", opts: ["Share it with others", "Not spread it further and report the message", "Save it for later", "Use it to find them"], correct: 1, explain: "Don't spread it further. Report the message and let a trusted adult know." },
    { q: "True or false: It's only doxxing if the person is famous.", opts: ["True", "False ‚Äî sharing anyone's private details without consent is doxxing"], correct: 1, explain: "Doxxing can happen to anyone. Every person has a right to privacy." },
    { q: "How can Sophie be helped after her address is shared?", opts: ["She can't be helped", "Adults can help secure her safety and address the situation with Aiden", "She should just move house", "She should leave all group chats"], correct: 1, explain: "Adults can intervene to ensure Sophie's safety, have the info removed, and address Aiden's behaviour." },
    { q: "What's the safest rule about other people's personal details?", opts: ["Share if you think it's okay", "Never share someone's private information without their explicit permission", "Only share with close friends", "Share if it's already public"], correct: 1, explain: "The safest rule: never share private details without explicit permission. When in doubt, don't share." }
  ]
});

// LESSONS 8-22 ‚Äî Adding all remaining
LESSONS.push(
  {
    id: 8, title: "Fake Profile / Impersonation", tag: "Identity",
    groupName: "Year 5 Chat üìñ", members: "You, Ruby, Max, Isla, Ethan, Poppy", avatar: "üé≠",
    goals: ["I can spot signs that a profile might be fake.", "I can report impersonation to protect others.", "I know not to trust everything I see online."],
    steps: [
      { chat: [
          { sender: "Unknown", text: "Hey it's Max! I made a new account cos I lost my phone", time: "7:00 pm", senderColor: "#e74c3c" },
          { sender: "Ruby", text: "Oh hey Max! That sucks üò¢", time: "7:01 pm" },
          { sender: "Unknown", text: "Yeah can you send me everyone's numbers so I can add them back?", time: "7:01 pm", senderColor: "#e74c3c" },
          { sender: "Isla", text: "Hmm this doesn't feel right‚Ä¶", time: "7:02 pm" },
          { type: "system", text: "This account says it's Max but the number is different from Max's usual number." }
        ],
        actions: [
          { label: "üì± Send the numbers", type: "bad", feedback: { title: "üö® Don't share!", text: "This might not really be Max! Sending everyone's phone numbers to an unverified account puts the whole group at risk. Always verify identity before sharing personal information.", mood: "bad" }},
          { label: "ü§î Ask a question only Max would know", type: "good", feedback: { title: "üëç Smart verification!", text: "Asking something only the real Max would know (like 'What did we do at lunch today?') is a clever way to check. Real friends can prove who they are.", mood: "good" }},
          { label: "üìû Contact real Max another way", type: "good", feedback: { title: "üåü Best approach!", text: "Reaching out to Max through a trusted channel ‚Äî asking their parent, seeing them at school, or calling their known number ‚Äî is the safest way to verify.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "The number is different from Max's usual one. How can you check if this is really Max?"
      }
    ],
    debrief: { happened: "Someone claiming to be Max joined with a different number and asked for everyone's phone numbers.", matters: "Fake profiles and impersonation are common tricks to collect personal information. Always verify someone's identity before sharing details.", nextTime: "If someone claims to be a friend from a new account, verify through a different channel. Never share personal information based on an unverified request." },
    practice: [
      { q: "What's a red flag that a profile might be fake?", opts: ["They say hello", "Different number, asking for personal info, new account", "They use emojis", "They're friendly"], correct: 1, explain: "New accounts with different numbers asking for personal details are classic impersonation signs." },
      { q: "How can you verify if someone is really who they say they are?", opts: ["Ask them to prove it through a question only they'd know", "Just trust them", "Send the info they want", "Ignore the message"], correct: 0, explain: "Ask a verification question or contact the real person through a different trusted channel." },
      { q: "Why would someone impersonate a friend?", opts: ["For fun", "To steal personal information or scam people", "Because they're bored", "To make new friends"], correct: 1, explain: "Impersonators typically want to collect personal data, spread scams, or cause harm." },
      { q: "'Unknown' asks for everyone's phone numbers. You should‚Ä¶", opts: ["Share them ‚Äî it's probably fine", "Refuse until the identity is verified", "Share just yours", "Ask a friend to share theirs first"], correct: 1, explain: "Never share personal information until you've confirmed who you're talking to." },
      { q: "Isla says 'This doesn't feel right.' She's using her‚Ä¶", opts: ["Phone wrong", "Instincts ‚Äî and she's right to be cautious", "Imagination", "Calculator"], correct: 1, explain: "Trusting your gut feeling when something seems off is an important digital safety skill." },
      { q: "What should you do if you discover a fake profile pretending to be someone you know?", opts: ["Follow it", "Report it to the platform and tell the real person", "Share it for laughs", "Ignore it completely"], correct: 1, explain: "Report impersonation accounts and let the real person know so they can take action too." },
      { q: "True or false: Profile pictures prove someone is who they claim to be.", opts: ["True ‚Äî pictures don't lie", "False ‚Äî anyone can use someone else's photo"], correct: 1, explain: "Photos can be easily copied. A profile picture alone never proves identity." },
      { q: "If a new account asks you to 'keep this between us', that's‚Ä¶", opts: ["Trustworthy", "A warning sign ‚Äî genuine people don't need secrecy", "Normal behaviour", "Romantic"], correct: 1, explain: "Asking for secrecy is a common manipulation tactic. Real friends don't need you to hide things." },
      { q: "The safest way to confirm Max lost their phone is to‚Ä¶", opts: ["Trust the new account", "Ask Max in person or call their parent", "Send a test message to the old number", "Do nothing"], correct: 1, explain: "Verifying through a trusted real-world channel is the safest approach." },
      { q: "What should you NEVER share with an unverified account?", opts: ["Favourite colour", "Phone numbers, addresses, passwords, or photos", "The weather", "Your opinion on movies"], correct: 1, explain: "Personal information like phone numbers, addresses, passwords, and photos should never be shared with unverified contacts." }
    ]
  },
  {
    id: 9, title: "Added to a Random Group", tag: "Safety",
    groupName: "üéµ FREE MUSIC üéµ", members: "+61 4XX XXX 001, +61 4XX XXX 002, You, +44 unknown numbers‚Ä¶", avatar: "‚ûï",
    goals: ["I can recognise when I've been added to a suspicious group.", "I know to leave immediately and not interact.", "I know how to adjust my settings so strangers can't add me."],
    steps: [
      { chat: [
          { type: "system", text: "You were added to this group by an unknown number." },
          { sender: "+61 4XX XXX 001", text: "Welcome!! Click the link for free Spotify premium üéµüî•", time: "8:30 pm" },
          { sender: "+61 4XX XXX 001", text: "https://t0tally-legit-sp0tify.com/free", time: "8:30 pm" },
          { sender: "+44 unknown", text: "OMG it works!! Thanks!!", time: "8:31 pm" },
          { type: "system", text: "You don't know anyone in this group." }
        ],
        actions: [
          { label: "üîó Click the link", type: "bad", feedback: { title: "üö® Danger!", text: "That link is almost certainly a scam or phishing attempt! The URL is misspelled ('t0tally-legit-sp0tify' uses zeros instead of o's). Never click links from unknown people or groups.", mood: "bad" }},
          { label: "üö™ Leave immediately", type: "good", feedback: { title: "‚úÖ Perfect!", text: "Leaving a random group immediately is the safest action. Don't interact, don't click anything, just leave. You can also report the group before leaving.", mood: "good" }},
          { label: "üí¨ Ask who added me", type: "caution", feedback: { title: "‚ö†Ô∏è Be careful!", text: "While it's natural to wonder, engaging with scam groups confirms your number is active, which can lead to more spam. It's safer to just leave.", mood: "caution" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "You don't know anyone here, and the link looks suspicious. What's the safest thing to do?"
      }
    ],
    debrief: { happened: "You were added to a random group by an unknown number. The group shared a suspicious link claiming to offer free Spotify.", matters: "Scammers add people to groups to spread malicious links. Clicking them can steal your personal information or infect your device.", nextTime: "Leave random groups immediately. Report them. Go to WhatsApp Settings ‚Üí Privacy ‚Üí Groups ‚Üí change to 'My contacts' so only people you know can add you." },
    practice: [
      { q: "You've been added to a group with unknown numbers. First thing to do?", opts: ["Say hello", "Click any links to see what the group is about", "Leave the group immediately", "Share it with friends"], correct: 2, explain: "Leave immediately. Don't interact with anyone or click anything." },
      { q: "The link says 'sp0tify' with a zero. This is a sign of‚Ä¶", opts: ["A real Spotify offer", "A phishing/scam link", "A new Spotify feature", "A typo"], correct: 1, explain: "Misspelled URLs using numbers instead of letters are a classic phishing technique." },
      { q: "Someone in the group says 'OMG it works!' This is probably‚Ä¶", opts: ["A genuine review", "A fake account trying to make the scam look real", "A friend of yours", "Proof the link is safe"], correct: 1, explain: "Scam groups often use fake 'testimonials' to trick people into clicking links." },
      { q: "How can you stop strangers from adding you to random groups?", opts: ["Delete WhatsApp", "Change Privacy settings ‚Üí Groups ‚Üí My contacts only", "Block everyone", "Turn off your phone"], correct: 1, explain: "WhatsApp's privacy settings let you control who can add you to groups." },
      { q: "Why shouldn't you reply to messages in a scam group?", opts: ["It's rude to reply", "Replying confirms your number is active, leading to more spam", "The messages will disappear", "It uses too much data"], correct: 1, explain: "Any interaction tells scammers your number is real and active, inviting more scam attempts." },
      { q: "Before leaving a scam group, you could also‚Ä¶", opts: ["Share the link", "Report the group to WhatsApp", "Add your friends", "Save the link for later"], correct: 1, explain: "Reporting helps WhatsApp shut down scam groups and protect others." },
      { q: "True or false: If a link offers something free, it's probably safe.", opts: ["True ‚Äî free is good!", "False ‚Äî 'too good to be true' offers are usually scams"], correct: 1, explain: "If something seems too good to be true, it probably is. Free offers from unknown sources are almost always scams." },
      { q: "What's the difference between a real Spotify link and a scam one?", opts: ["There's no difference", "Real links use the correct domain (spotify.com), scams use misspellings", "Scam links are shorter", "Real links have more emojis"], correct: 1, explain: "Real companies use their official domain. Watch for misspellings, extra characters, or strange domains." },
      { q: "You should tell a trusted adult if‚Ä¶", opts: ["You got free music", "You were added to a random group or clicked a suspicious link", "You left a group", "You received a normal message"], correct: 1, explain: "Let a trusted adult know so they can check your device for problems and help you secure your account." },
      { q: "What WhatsApp setting helps protect you from random groups?", opts: ["Dark mode", "Privacy ‚Üí Groups ‚Üí My contacts", "Read receipts", "Font size"], correct: 1, explain: "Settings ‚Üí Privacy ‚Üí Groups ‚Üí My contacts ensures only people in your contacts can add you to groups." }
    ]
  },
  {
    id: 10, title: '"Click This Link Now" Urgency', tag: "Scams",
    groupName: "Family Chat üë®‚Äçüë©‚Äçüëß‚Äçüë¶", members: "You, Mum, Dad, Uncle Rob, Aunty Mel, Cousin Jess", avatar: "üîó",
    goals: ["I can recognise urgency tactics used in scam messages.", "I know never to click suspicious links, even from people I know.", "I can check with the sender through another channel before acting."],
    steps: [
      { chat: [
          { sender: "Uncle Rob", text: "URGENT!! Your account has been compromised!!", time: "9:15 pm" },
          { sender: "Uncle Rob", text: "Click here NOW to secure it: https://wh4tsapp-security.net/fix", time: "9:15 pm" },
          { sender: "Uncle Rob", text: "DO IT NOW before they lock you out!!! ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è", time: "9:16 pm" },
          { type: "system", text: "Uncle Rob's account might have been hacked. He usually doesn't type like this." }
        ],
        actions: [
          { label: "üîó Click the link", type: "bad", feedback: { title: "üö® STOP!", text: "This is a phishing scam! The link 'wh4tsapp-security.net' is NOT WhatsApp's real website. Urgency and ALL CAPS are classic scam tactics. Uncle Rob's account may have been hacked.", mood: "bad" }},
          { label: "üìû Call Uncle Rob to check", type: "good", feedback: { title: "üåü Excellent thinking!", text: "Calling Uncle Rob on the phone (not through WhatsApp) lets you verify if he really sent this. If he didn't, his account has been compromised and he needs to know.", mood: "good" }},
          { label: "‚è∏Ô∏è Pause ‚Äî don't click", type: "good", feedback: { title: "üëç Smart!", text: "Pausing when you feel pressured is exactly right. Scams use urgency ('NOW!', 'URGENT!') to make you act before thinking. Real security alerts don't come through WhatsApp messages.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Uncle Rob usually doesn't type in ALL CAPS. The link has numbers instead of letters. Something is wrong."
      }
    ],
    debrief: { happened: "A message from Uncle Rob's account used urgency and a fake link to try to get you to click.", matters: "Scammers use urgency, fear, and trusted names to trick people. Even messages from family members might be from hacked accounts.", nextTime: "Pause when you feel rushed. Check the URL carefully. Verify with the sender through a different channel (phone call, in person). Real companies don't send urgent security links through WhatsApp." },
    practice: [
      { q: "A message says 'URGENT!! Click NOW!!' This language is designed to‚Ä¶", opts: ["Help you stay safe", "Make you act without thinking", "Be friendly", "Share good news"], correct: 1, explain: "Urgency language is a scam tactic to make you click before you have time to think critically." },
      { q: "The link says 'wh4tsapp-security.net'. What's wrong with it?", opts: ["Nothing ‚Äî it looks official", "It uses a number instead of a letter and isn't WhatsApp's real domain", "It's too long", "It's missing emojis"], correct: 1, explain: "The misspelled URL and unofficial domain are clear signs of a phishing link." },
      { q: "Uncle Rob 'usually doesn't type like this.' Why is this important?", opts: ["It's not important", "A change in communication style might mean the account was hacked", "He's just excited", "He got a new phone"], correct: 1, explain: "When someone suddenly communicates very differently, their account may have been compromised." },
      { q: "The best way to check if a message from a family member is real is to‚Ä¶", opts: ["Reply on WhatsApp asking 'Is this you?'", "Call them on the phone or ask in person", "Click the link to find out", "Ignore it forever"], correct: 1, explain: "Verifying through a different channel (phone call, in person) is the only safe way to check." },
      { q: "Real WhatsApp security alerts come through‚Ä¶", opts: ["Group chats from family", "The WhatsApp app itself, not messages from contacts", "Email from strangers", "Text messages with links"], correct: 1, explain: "WhatsApp sends security information through its own app interface, not through chat messages." },
      { q: "If Uncle Rob's account WAS hacked, what should he do?", opts: ["Nothing", "Enable two-step verification and alert contacts", "Make a new account with the same number", "Delete all messages"], correct: 1, explain: "Enabling two-step verification, changing passwords, and warning contacts are the right steps after an account compromise." },
      { q: "You almost clicked the link but stopped yourself. You should now‚Ä¶", opts: ["Click it anyway", "Tell a parent/carer what happened", "Delete the conversation and forget about it", "Forward the link to friends as a warning"], correct: 1, explain: "Tell a trusted adult so they can help verify with Uncle Rob and warn other family members." },
      { q: "True or false: Scam links can only come from strangers.", opts: ["True ‚Äî family and friends are always safe", "False ‚Äî hacked accounts can send scams from people you know"], correct: 1, explain: "Hacked accounts mean scam messages can come from anyone, even trusted contacts." },
      { q: "What are THREE signs of a scam message?", opts: ["Short, friendly, normal", "Urgency, suspicious links, unusual language from the sender", "Emojis, timestamps, read receipts", "Photos, videos, stickers"], correct: 1, explain: "Urgency tactics, suspicious URLs, and uncharacteristic communication are the three main red flags." },
      { q: "What does 'phishing' mean?", opts: ["Going fishing", "Tricking people into giving away personal information through fake messages or websites", "Sending photos of fish", "A WhatsApp feature"], correct: 1, explain: "Phishing is when scammers use fake messages, links, or websites to trick you into revealing personal information." }
    ]
  }
);

// LESSONS 11-22
LESSONS.push(
  { id: 11, title: "Verification Code Trap", tag: "Scams",
    groupName: "Class Group üìö", members: "You, Olivia, Tom, Freya, Ash", avatar: "üî¢",
    goals: ["I can understand that verification codes must never be shared.", "I can recognise a verification code scam.", "I know what to do if someone asks for my code."],
    steps: [
      { chat: [
          { sender: "Olivia", text: "Hey! I accidentally sent a verification code to your number üòÖ", time: "4:45 pm" },
          { sender: "Olivia", text: "Can you just send me the 6-digit code? I need it to log in", time: "4:45 pm" },
          { type: "system", text: "You just received a text message with a WhatsApp verification code." }
        ],
        actions: [
          { label: "üî¢ Send the code", type: "bad", feedback: { title: "üö® STOP! That's your code!", text: "That verification code was sent to YOUR number for YOUR account. Sharing it lets someone else take over your WhatsApp account. This is one of the most common scams!", mood: "bad" }},
          { label: "üö´ Don't send it", type: "good", feedback: { title: "‚úÖ Correct!", text: "A verification code sent to your phone is for YOUR account only. Nobody else needs it, ever. 'Olivia' may not even be the real Olivia ‚Äî their account might be hacked.", mood: "good" }},
          { label: "üë§ Tell a trusted adult", type: "good", feedback: { title: "üåü Smart move!", text: "Telling an adult means they can help you secure your account and warn others about the scam.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "The verification code was sent to YOUR phone number. It's for YOUR account."
      }
    ],
    debrief: { happened: "Someone (claiming to be Olivia) asked you to share a verification code that was sent to your phone.", matters: "Verification codes are the key to your account. Sharing them gives someone else complete access to your WhatsApp. This is one of the most common account theft methods.", nextTime: "NEVER share verification codes. No one legitimately needs a code sent to your phone. Enable two-step verification for extra security. Tell a trusted adult if anyone asks for your code." },
    practice: [
      { q: "A verification code sent to YOUR phone is for‚Ä¶", opts: ["Anyone who needs it", "YOUR account only ‚Äî never share it", "The person who asked for it", "WhatsApp customer service"], correct: 1, explain: "Verification codes are exclusively for your own account. Sharing them gives others access." },
      { q: "Why might 'Olivia' be asking for your code?", opts: ["She genuinely made a mistake", "Her account may be hacked and someone is trying to steal yours", "She needs it for homework", "WhatsApp told her to"], correct: 1, explain: "This is a classic scam. Olivia's account may have been compromised and is being used to trick you." },
      { q: "What happens if you share your verification code?", opts: ["Nothing", "Someone can take over your WhatsApp account", "You get a free upgrade", "Your phone resets"], correct: 1, explain: "Sharing your code lets someone log into your account on their device, locking you out." },
      { q: "True or false: A friend might legitimately need a code sent to your phone.", opts: ["True ‚Äî it happens sometimes", "False ‚Äî verification codes are always for the person who receives them"], correct: 1, explain: "Verification codes are ALWAYS for the phone that receives them. No legitimate reason exists for sharing them." },
      { q: "What extra security can you enable on WhatsApp?", opts: ["Bigger font", "Two-step verification (a PIN you create)", "More emojis", "Dark mode"], correct: 1, explain: "Two-step verification adds a PIN that's needed in addition to the SMS code, making your account much harder to steal." },
      { q: "If someone steals your WhatsApp account, they can‚Ä¶", opts: ["Nothing serious", "Read your messages, message your contacts, and pretend to be you", "Only see your profile picture", "Only change your status"], correct: 1, explain: "Account takeover gives full access ‚Äî they can read messages, impersonate you, and scam your contacts." },
      { q: "You accidentally shared your code. What should you do NOW?", opts: ["Wait and see what happens", "Immediately re-verify your account and tell a trusted adult", "Delete WhatsApp", "Send another code"], correct: 1, explain: "Act fast: re-verify your account by requesting a new code, enable two-step verification, and tell an adult." },
      { q: "How can you tell this might be a scam and not really Olivia?", opts: ["You can't tell", "The timing of the 'accidental' code and the request is suspicious", "Olivia is always trustworthy", "The message had no emojis"], correct: 1, explain: "The coincidence of receiving a code and immediately being asked for it is the hallmark of this scam." },
      { q: "A safe rule about verification codes is‚Ä¶", opts: ["Share them with friends you trust", "NEVER share them with anyone, no matter who asks", "Only share with family", "Share them if someone says it's urgent"], correct: 1, explain: "The rule is absolute: never share verification codes with anyone, ever." },
      { q: "After this experience, you should warn‚Ä¶", opts: ["No one", "Your friends and family about this type of scam", "Only Olivia", "Social media followers"], correct: 1, explain: "Warning others helps protect them from falling for the same scam." }
    ]
  },
  { id: 12, title: '"Free Prize / Free Vouchers" Scam', tag: "Scams",
    groupName: "Fun Stuff üéÆ", members: "You, Zach, Amy, Leo, Bella", avatar: "üéÅ",
    goals: ["I can recognise 'too good to be true' offers.", "I know not to click links or fill in forms from unknown sources.", "I can warn others when I spot a scam."],
    steps: [
      { chat: [
          { sender: "Zach", text: "FREE $100 ROBLOX GIFT CARD!! My cousin got one!!", time: "5:00 pm" },
          { sender: "Zach", text: "Just fill in this form: https://fr33-r0blox-cards.xyz/claim", fwd: "Forwarded many times", time: "5:00 pm" },
          { sender: "Amy", text: "Is this real?? üò±", time: "5:01 pm" },
          { sender: "Leo", text: "Filling it in now!!", time: "5:01 pm" }
        ],
        actions: [
          { label: "üéÅ Fill in the form", type: "bad", feedback: { title: "üö® It's a scam!", text: "Free gift card offers that ask for personal information are ALWAYS scams. The website 'fr33-r0blox-cards.xyz' uses number substitutions and an unusual domain ‚Äî clear red flags.", mood: "bad" }},
          { label: "‚ö†Ô∏è Warn the group it's a scam", type: "good", feedback: { title: "üåü Excellent!", text: "Warning your friends can stop them from giving away their personal information. You could say: 'This is a scam ‚Äî the link looks fake. Don't fill anything in!'", mood: "good" }},
          { label: "üö´ Don't click ‚Äî ignore it", type: "caution", feedback: { title: "üëç Safe for you, but‚Ä¶", text: "Not clicking is safe for you, but Leo is about to give away his personal information. Warning the group would help protect everyone.", mood: "caution" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Look at the link carefully. 'fr33-r0blox' uses numbers instead of letters. Is this a real Roblox website?"
      }
    ],
    debrief: { happened: "A forwarded message offered free Roblox gift cards through a suspicious link.", matters: "Scammers use popular games and 'free' offers to trick young people into entering personal information. These forms can steal passwords, addresses, and more.", nextTime: "If it sounds too good to be true, it is. Check URLs carefully. Real companies don't give away free stuff through random WhatsApp links. Warn friends if you spot a scam." },
    practice: [
      { q: "'Free $100 gift card' from a random link is most likely‚Ä¶", opts: ["A real offer", "A scam", "A reward for being a good student", "A WhatsApp feature"], correct: 1, explain: "Free gift card offers from random links are virtually always scams designed to steal personal information." },
      { q: "The link uses 'fr33' and 'r0blox'. Why is this suspicious?", opts: ["It's trendy spelling", "Scammers use number substitutions to create fake URLs that look similar to real ones", "Roblox changed their spelling", "It's a shortcut"], correct: 1, explain: "Number substitutions in URLs are a phishing technique to create convincing fake websites." },
      { q: "Leo says he's filling in the form. You should‚Ä¶", opts: ["Let him ‚Äî it's his choice", "Warn him immediately that it's a scam", "Fill it in too so you both get cards", "Ask him to share his gift card"], correct: 1, explain: "Warning Leo quickly could stop him from giving away personal information to scammers." },
      { q: "What information might a scam form ask for?", opts: ["Just your favourite colour", "Name, address, phone number, passwords, bank details", "Only your Roblox username", "Nothing ‚Äî it just gives you a card"], correct: 1, explain: "Scam forms collect personal details they can use for identity theft or further scams." },
      { q: "The message is labelled 'Forwarded many times'. This means‚Ä¶", opts: ["It's been verified by WhatsApp", "Many people have spread it ‚Äî which is common with scams", "It's definitely real", "Roblox sent it"], correct: 1, explain: "The 'forwarded many times' label means it's been widely shared, which is very common with viral scams." },
      { q: "True or false: If your friend sent it, the link must be safe.", opts: ["True ‚Äî friends only share safe things", "False ‚Äî friends can unknowingly share scams"], correct: 1, explain: "Friends often share scams without realising. Always evaluate links independently, regardless of who sent them." },
      { q: "What's the safest way to get Roblox gift cards?", opts: ["Through random WhatsApp links", "From official stores or the Roblox website", "From forms that ask for personal info", "From strangers online"], correct: 1, explain: "Only buy or receive gift cards through official, verified channels." },
      { q: "Zach says 'My cousin got one!' This is probably‚Ä¶", opts: ["True ‚Äî his cousin is lucky", "Made up or based on a misunderstanding", "Proof the offer is real", "A guarantee you'll get one too"], correct: 1, explain: "Claims of others receiving the offer are common scam tactics to build false credibility." },
      { q: "If you accidentally filled in a scam form, you should‚Ä¶", opts: ["Do nothing", "Tell a trusted adult immediately and change any passwords you shared", "Fill in more forms for more cards", "Wait for the gift card"], correct: 1, explain: "Act fast: tell an adult, change passwords, and monitor accounts for suspicious activity." },
      { q: "How can you help protect your group from scams?", opts: ["Share every link you find", "Learn to spot scam signs and warn others when you see them", "Ignore all messages", "Leave all groups"], correct: 1, explain: "Being digitally literate and warning others helps create a safer group for everyone." }
    ]
  },
  { id: 13, title: 'Account Takeover = Messages From "You"', tag: "Security",
    groupName: "My Groups üì±", members: "You, various friends", avatar: "üëª",
    goals: ["I can understand how accounts get taken over.", "I can recognise signs that a friend's account has been compromised.", "I know how to secure my own account."],
    steps: [
      { chat: [
          { type: "system", text: "Your friend Jess messages you. But something seems off‚Ä¶" },
          { sender: "Jess", text: "Hey I need help urgently!! Can you send me $50 through this link?", time: "6:30 pm" },
          { sender: "Jess", text: "I'll pay you back tomorrow I promise!! Please hurry!!", time: "6:30 pm" },
          { sender: "Jess", text: "Don't tell anyone ok? It's embarrassing üò∞", time: "6:31 pm" }
        ],
        actions: [
          { label: "üí∞ Help Jess ‚Äî send money", type: "bad", feedback: { title: "üö® Wait!", text: "This probably isn't Jess! Account takeover scams use urgency and secrecy ('don't tell anyone'). Always verify through a different channel before sending money.", mood: "bad" }},
          { label: "üìû Call Jess to verify", type: "good", feedback: { title: "üåü Perfect!", text: "Calling Jess directly (not through WhatsApp) lets you check if she really sent these messages. If she didn't, her account has been compromised.", mood: "good" }},
          { label: "ü§î Something feels off ‚Äî don't act", type: "good", feedback: { title: "üëç Trusting your instincts!", text: "The urgency, money request, and 'don't tell anyone' are all red flags. Pausing when something feels wrong is a smart safety habit.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Three red flags: urgency, money request, and 'don't tell anyone'. Does this sound like Jess?"
      }
    ],
    debrief: { happened: "Messages from 'Jess' asked for money urgently and said to keep it secret.", matters: "When accounts are taken over, scammers send messages as 'you' to your contacts. They use urgency and secrecy to prevent victims from checking.", nextTime: "Always verify unusual requests through a different channel. Set up two-step verification. Never send money based on a message alone." },
    practice: [
      { q: "What are the red flags in 'Jess's' messages?", opts: ["She used emojis", "Urgency, money request, and asking for secrecy", "She said please", "She messaged in the evening"], correct: 1, explain: "Urgency, money requests, and secrecy are the classic trio of account takeover scam tactics." },
      { q: "'Don't tell anyone' is a red flag because‚Ä¶", opts: ["It's rude", "It prevents you from checking with others who might spot the scam", "It's a secret", "It means the info is classified"], correct: 1, explain: "Scammers ask for secrecy to stop you from verifying the story with other people." },
      { q: "How do accounts get taken over?", opts: ["By magic", "Through shared verification codes, weak passwords, or phishing", "By using WhatsApp too much", "Through official updates"], correct: 1, explain: "Most account takeovers happen through shared verification codes, weak passwords, or clicking phishing links." },
      { q: "Before sending money to anyone online, always‚Ä¶", opts: ["Send it quickly to be helpful", "Verify the request through a different communication channel", "Ask for more money in return", "Tell them to wait a year"], correct: 1, explain: "Always verify money requests by calling or seeing the person face-to-face before transferring anything." },
      { q: "How can you protect your own account from takeover?", opts: ["Share your password with friends for safekeeping", "Enable two-step verification and never share codes", "Use a simple password like '123456'", "Let friends log into your account"], correct: 1, explain: "Two-step verification and never sharing codes or passwords are your best protections." },
      { q: "If Jess's account really was taken over, you should‚Ä¶", opts: ["Ignore it", "Tell Jess through another channel and warn mutual contacts", "Keep messaging 'Jess' on WhatsApp", "Send the money just in case"], correct: 1, explain: "Alerting the real Jess and warning mutual contacts helps everyone stay safe." },
      { q: "True or false: You can always trust messages from contacts you know.", opts: ["True ‚Äî if it's from their number, it's them", "False ‚Äî compromised accounts send messages that look like they're from your friend"], correct: 1, explain: "Account takeover means messages appear to come from your friend but are actually from a scammer." },
      { q: "What should Jess do if her account was taken over?", opts: ["Make a new account", "Contact WhatsApp support, re-verify, enable two-step verification, and warn contacts", "Nothing ‚Äî it'll fix itself", "Delete the app"], correct: 1, explain: "Re-verification, two-step verification, and warning contacts are the essential recovery steps." },
      { q: "A legitimate friend in genuine need would probably‚Ä¶", opts: ["Ask through multiple channels and be okay with you verifying", "Demand secrecy and urgency through one message", "Threaten you if you don't help fast", "Use all caps and exclamation marks"], correct: 0, explain: "A real friend would understand your need to verify and wouldn't demand absolute secrecy." },
      { q: "Two-step verification on WhatsApp means‚Ä¶", opts: ["You verify your identity twice when logging in", "You create a PIN that's needed in addition to the SMS code", "You need two phones", "Two people approve your messages"], correct: 1, explain: "Two-step verification adds a personal PIN, making it much harder for anyone to access your account even if they have your verification code." }
    ]
  }
);

// LESSONS 14-22
LESSONS.push(
  { id: 14, title: "Unwanted Contact / Grooming Red Flags", tag: "Safety",
    groupName: "Gaming Friends üéÆ", members: "You, Charlie, unknown contacts", avatar: "üö©",
    goals: ["I can recognise grooming red flags like excessive flattery and secrecy.", "I know to never meet someone I've only spoken to online without a trusted adult.", "I can block, report, and tell a trusted adult immediately."],
    steps: [
      { chat: [
          { sender: "GamePro99", text: "Hey! Saw you in the gaming group. You're really good!", time: "7:00 pm", senderColor: "#e74c3c" },
          { sender: "GamePro99", text: "I'm 14 too. What school do you go to?", time: "7:01 pm", senderColor: "#e74c3c" },
          { sender: "GamePro99", text: "Don't tell your parents about our chat ‚Äî they wouldn't understand gaming friends üòâ", time: "7:03 pm", senderColor: "#e74c3c" },
          { type: "system", text: "‚ö†Ô∏è You don't know this person. They're asking personal questions and telling you to keep secrets from your parents." }
        ],
        actions: [
          { label: "üí¨ Reply and chat", type: "bad", feedback: { title: "üö® Red flags!", text: "This person is showing grooming signs: excessive flattery, asking personal questions, and telling you to keep secrets from parents. NEVER continue chatting with someone who shows these signs.", mood: "bad" }},
          { label: "üö´ Block and report", type: "good", feedback: { title: "‚úÖ Exactly right!", text: "Blocking prevents them from contacting you. Reporting alerts WhatsApp to investigate the account. These are your first-line defences.", mood: "good" }},
          { label: "üë§ Tell a trusted adult NOW", type: "good", feedback: { title: "üåü Essential!", text: "An adult needs to know about this immediately. Show them the messages. You are not in trouble ‚Äî the person contacting you is behaving dangerously.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Three red flags: asking personal questions, flattery, and 'don't tell your parents.' This is a safety issue."
      }
    ],
    debrief: { happened: "An unknown person contacted you with flattery, asked personal questions, and told you to keep the conversation secret.", matters: "These are grooming red flags. Groomers build trust then exploit it. Key signs: excessive compliments, personal questions, gifts/offers, secrecy from adults, and gradually pushing boundaries.", nextTime: "Never share personal information with people you don't know in real life. Block and report immediately. ALWAYS tell a trusted adult ‚Äî you will NOT be in trouble. Show them the messages." },
    practice: [
      { q: "What is 'grooming' in the online context?", opts: ["Hair styling", "When someone builds trust with a young person to exploit them", "Making friends online", "A WhatsApp feature"], correct: 1, explain: "Online grooming is when someone builds a relationship with a young person to manipulate and exploit them." },
      { q: "'Don't tell your parents' is a red flag because‚Ä¶", opts: ["Parents are strict", "People with good intentions don't ask children to keep secrets from their caregivers", "Parents don't understand technology", "It's a normal request"], correct: 1, explain: "Asking a young person to hide a relationship from trusted adults is a major grooming warning sign." },
      { q: "Someone online says they're your age. You should‚Ä¶", opts: ["Believe them completely", "Remember that you can't verify ages online ‚Äî be cautious", "Share your age too", "Ask for proof"], correct: 1, explain: "Anyone can claim any age online. You cannot verify who someone really is through messages alone." },
      { q: "Excessive flattery from a stranger is‚Ä¶", opts: ["A sign they're nice", "A common grooming technique to build trust", "Normal in group chats", "Something to be grateful for"], correct: 1, explain: "Over-the-top compliments from strangers are a manipulation tactic to make you feel special and lower your guard." },
      { q: "If someone online asks what school you go to, you should‚Ä¶", opts: ["Tell them ‚Äî it's just a school", "Never share this ‚Äî it reveals where you can be physically found", "Only tell if they tell you theirs first", "Lie about your school"], correct: 1, explain: "Your school name reveals your physical location and daily routine. Never share it with strangers online." },
      { q: "Someone online offers you free game credits if you share a photo. You should‚Ä¶", opts: ["Send the photo for free credits", "Refuse, block, report, and tell an adult", "Negotiate for more credits", "Ask a friend what to do"], correct: 1, explain: "Offering gifts in exchange for photos is a grooming and exploitation tactic. Block, report, and tell an adult." },
      { q: "If you tell a trusted adult about concerning messages, you‚Ä¶", opts: ["Will be in trouble", "Will NOT be in trouble ‚Äî adults need to know to keep you safe", "Should expect punishment", "Shouldn't have been chatting"], correct: 1, explain: "You are never in trouble for reporting concerning contact. Adults need this information to protect you." },
      { q: "True or false: Someone who grooms a child always seems scary or mean.", opts: ["True ‚Äî they're easy to spot", "False ‚Äî groomers are often friendly, kind, and likeable at first"], correct: 1, explain: "Groomers deliberately appear friendly and trustworthy. That's what makes grooming so dangerous." },
      { q: "What should you do with concerning messages BEFORE blocking?", opts: ["Delete them to forget about it", "Take screenshots or show a trusted adult so there's evidence", "Reply to them", "Forward them to friends"], correct: 1, explain: "Evidence helps adults and authorities take action. Show messages to a trusted adult before blocking." },
      { q: "Is it safe to meet someone you've only spoken to online?", opts: ["Yes if they seem nice", "NEVER without a trusted adult present ‚Äî and only if an adult agrees", "Yes if you meet in a public place", "Yes if they send a photo"], correct: 1, explain: "Never meet online contacts without a trusted adult knowing and being present. This is a non-negotiable safety rule." }
    ]
  },
  { id: 15, title: 'Threats and Blackmail ("If you don\'t‚Ä¶")', tag: "Safety",
    groupName: "Direct Message üí¨", members: "You, Unknown", avatar: "‚ö†Ô∏è",
    goals: ["I can recognise threats and blackmail.", "I know that giving in to threats makes things worse.", "I know to save evidence and tell a trusted adult immediately."],
    steps: [
      { chat: [
          { sender: "Unknown", text: "I have screenshots of your chat. If you don't send me $50 I'll share them with your whole school.", time: "8:00 pm", senderColor: "#e74c3c" },
          { sender: "Unknown", text: "You have 1 hour. Don't tell anyone or it gets worse. ‚è∞", time: "8:00 pm", senderColor: "#e74c3c" },
          { type: "system", text: "‚ö†Ô∏è This person is threatening you. This is blackmail and it is a crime." }
        ],
        actions: [
          { label: "üí∞ Pay them", type: "bad", feedback: { title: "üö® Don't pay!", text: "Paying a blackmailer NEVER makes it stop. They'll just ask for more. This is a crime and you need adult help immediately.", mood: "bad" }},
          { label: "üì∏ Screenshot the threats", type: "good", feedback: { title: "‚úÖ Save evidence!", text: "Screenshots of threatening messages are important evidence. Don't delete anything ‚Äî save it all and show a trusted adult.", mood: "good" }},
          { label: "üë§ Tell a trusted adult NOW", type: "good", feedback: { title: "üåü The most important step!", text: "This is a crime. A trusted adult can help you report this to the police. You are NOT in trouble ‚Äî the person threatening you is the one breaking the law. Show them everything.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "This is blackmail ‚Äî a crime. You need adult help NOW. Don't give in to the threat."
      }
    ],
    debrief: { happened: "Someone threatened to share your private messages unless you paid them money.", matters: "This is blackmail, and it's a crime. Giving in doesn't make it stop ‚Äî it gets worse. You are not to blame.", nextTime: "Save all evidence (screenshots). Tell a trusted adult IMMEDIATELY. This can be reported to police and the eSafety Commissioner. You are never in trouble for being a victim of threats." },
    practice: [
      { q: "What is blackmail?", opts: ["A type of email", "Threatening to expose information unless you do what they want", "A WhatsApp feature", "Dark mode"], correct: 1, explain: "Blackmail is threatening to reveal information or cause harm unless the victim complies with demands." },
      { q: "If you pay a blackmailer, they will‚Ä¶", opts: ["Go away forever", "Most likely ask for more because they know you'll pay", "Thank you and stop", "Become your friend"], correct: 1, explain: "Paying proves you can be pressured into compliance, leading to escalating demands." },
      { q: "'Don't tell anyone or it gets worse' is meant to‚Ä¶", opts: ["Protect you", "Isolate you from people who can help", "Give good advice", "Keep you safe"], correct: 1, explain: "Blackmailers use secrecy threats to prevent you from getting help from adults who can stop them." },
      { q: "Who should you tell first if you receive threats?", opts: ["The person threatening you", "A trusted adult ‚Äî parent, carer, teacher, or police", "Your followers on social media", "No one ‚Äî handle it alone"], correct: 1, explain: "Trusted adults have the power and knowledge to protect you and take legal action." },
      { q: "True or false: If you're being threatened online, it's partly your fault.", opts: ["True", "False ‚Äî the person making threats is 100% responsible for their criminal behaviour"], correct: 1, explain: "You are never to blame for someone else's criminal behaviour. Threats and blackmail are always the perpetrator's fault." },
      { q: "What should you do with threatening messages?", opts: ["Delete them immediately", "Keep them as evidence ‚Äî screenshot and save", "Reply with threats back", "Forward them to friends"], correct: 1, explain: "Evidence is essential for adults and authorities to take action. Save everything." },
      { q: "In Australia, where can online threats be reported?", opts: ["Nowhere", "To the eSafety Commissioner and police", "Only to WhatsApp", "Only to your school"], correct: 1, explain: "The eSafety Commissioner (esafety.gov.au) handles online threats, and police investigate criminal blackmail." },
      { q: "A friend tells you they're being threatened online. You should‚Ä¶", opts: ["Tell them to handle it alone", "Help them tell a trusted adult and offer support", "Ignore it ‚Äî it's not your problem", "Confront the person threatening them"], correct: 1, explain: "Help your friend reach a trusted adult. Your support and encouragement could be exactly what they need." },
      { q: "Blackmail is‚Ä¶", opts: ["Just words ‚Äî not a real crime", "A criminal offence that can be investigated by police", "Something only adults deal with", "Normal online behaviour"], correct: 1, explain: "Blackmail is a serious criminal offence regardless of the victim's age." },
      { q: "What three steps should you take if threatened online?", opts: ["Pay, hide, forget", "Save evidence, tell a trusted adult, report to authorities", "Delete everything, change your number, pretend it didn't happen", "Threaten them back, block, ignore"], correct: 1, explain: "Save evidence, tell a trusted adult immediately, and report to authorities. These three steps protect you." }
    ]
  },
  { id: 16, title: '"Delete It, It Disappears" Myth', tag: "Digital Footprint",
    groupName: "Friends Chat üí¨", members: "You, Mia, Ryan, Jade", avatar: "üí®",
    goals: ["I can understand that deleted messages may still exist as screenshots or backups.", "I can think before I send because nothing truly disappears.", "I can make careful choices about what I share digitally."],
    steps: [
      { chat: [
          { sender: "Ryan", text: "I'll delete it in 5 seconds so it's totally gone!! Send me that photo quick!", time: "4:00 pm" },
          { sender: "Mia", text: "Yeah disappearing messages mean no one can keep it", time: "4:00 pm" },
          { sender: "Jade", text: "Hmm I don't think that's how it works‚Ä¶", time: "4:01 pm" }
        ],
        actions: [
          { label: "üì∏ Send the photo", type: "bad", feedback: { title: "‚ö†Ô∏è Nothing truly disappears!", text: "Even 'disappearing' messages can be screenshotted, saved, or backed up. Once you send something digital, you lose control of it. Jade is right to question this.", mood: "bad" }},
          { label: "ü§î Agree with Jade", type: "good", feedback: { title: "üëç Correct!", text: "Jade is right ‚Äî deleting or using disappearing messages doesn't guarantee the content is gone. Screenshots, backups, and other devices can preserve anything you send.", mood: "good" }},
          { label: "üö´ Don't send anything private", type: "good", feedback: { title: "‚úÖ Smart rule!", text: "The safest approach: don't send anything you wouldn't want everyone to see. Once it's sent, you can't take it back.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Can you truly guarantee something is deleted from everyone's phones? Think about screenshots."
      }
    ],
    debrief: { happened: "Friends claimed that deleting messages or using disappearing messages makes content completely disappear.", matters: "Digital content can be screenshotted, backed up, or recovered. 'Deleting' only removes YOUR copy. The golden rule: never send anything you wouldn't want everyone to see.", nextTime: "Before sending any message or photo, ask: 'Would I be okay if this was seen by my parents, teachers, or the whole school?' If not, don't send it." },
    practice: [
      { q: "When you 'delete for everyone' on WhatsApp, the message is‚Ä¶", opts: ["Gone forever from all devices", "Removed from the chat but may exist as screenshots or backups", "Deleted from the internet", "Permanently erased from existence"], correct: 1, explain: "Deletion removes the message from the chat view, but copies may exist as screenshots, in backups, or in notifications." },
      { q: "Disappearing messages mean‚Ä¶", opts: ["Total privacy guaranteed", "Messages auto-delete, but can still be screenshotted or copied before they disappear", "No one can ever see them", "They're encrypted beyond recovery"], correct: 1, explain: "Disappearing messages have a time limit, but anyone can screenshot or copy content before it vanishes." },
      { q: "The golden rule before sending anything is‚Ä¶", opts: ["Send it fast so no one sees you typing", "Ask: would I be okay if everyone saw this?", "Only send to close friends", "Use disappearing messages mode"], correct: 1, explain: "If you wouldn't want it seen by parents, teachers, or your whole school, don't send it." },
      { q: "Someone says 'I'll delete it in 5 seconds.' Can you trust this?", opts: ["Yes ‚Äî 5 seconds is very quick", "No ‚Äî anyone could screenshot in less than a second", "Yes ‚Äî WhatsApp prevents screenshots", "Yes ‚Äî if they promise"], correct: 1, explain: "Screenshots take less than a second. There's no way to guarantee content won't be captured." },
      { q: "True or false: WhatsApp prevents people from taking screenshots.", opts: ["True ‚Äî screenshots are blocked", "False ‚Äî WhatsApp does not prevent screenshots"], correct: 1, explain: "WhatsApp does not block screenshots. Anyone can capture what's on their screen at any time." },
      { q: "A 'digital footprint' means‚Ä¶", opts: ["Your shoe size online", "The trail of data you leave behind from your online activity", "A type of emoji", "How fast you type"], correct: 1, explain: "Your digital footprint includes everything you post, send, like, and share online." },
      { q: "What could happen if a private photo you sent gets screenshotted?", opts: ["Nothing", "It could be shared widely without your consent", "The screenshot deletes automatically", "Only the person who took it can see it"], correct: 1, explain: "Once screenshotted, that image could be shared with anyone, anywhere, without your control." },
      { q: "Ryan says the photo will be 'totally gone.' Jade disagrees. Who is right?", opts: ["Ryan ‚Äî deleting works perfectly", "Jade ‚Äî nothing truly disappears once sent digitally", "Neither ‚Äî it depends on the phone", "Both ‚Äî sometimes it disappears, sometimes not"], correct: 1, explain: "Jade is correct. Digital content can persist through screenshots, backups, and other copies." },
      { q: "The safest way to keep something private is to‚Ä¶", opts: ["Send it with disappearing messages", "Not send it digitally at all", "Delete it really fast", "Only send to one person"], correct: 1, explain: "The only way to guarantee privacy is to not send it digitally. Once shared, you lose control." },
      { q: "If someone pressures you to send something private by saying 'I'll delete it', you should‚Ä¶", opts: ["Trust them and send it", "Refuse ‚Äî the promise of deletion is not a guarantee of privacy", "Send it only if they're a close friend", "Ask them to pinky promise"], correct: 1, explain: "Promises to delete provide no real protection. Refuse and explain that you're not comfortable sending it." }
    ]
  },
  { id: 17, title: "Pressure to Send Photos", tag: "Safety",
    groupName: "Direct Message üí¨", members: "You, Someone", avatar: "üì∑",
    goals: ["I know that no one should ever pressure me to send photos.", "I can say no and tell a trusted adult.", "I understand that sharing intimate images of minors is a crime."],
    steps: [
      { chat: [
          { sender: "Someone", text: "Send me a selfie? I sent you one‚Ä¶ it's only fair", time: "8:30 pm" },
          { sender: "Someone", text: "If you don't I'll think you don't trust me üò¢", time: "8:31 pm" },
          { sender: "Someone", text: "No one else will ever see it I promise", time: "8:31 pm" },
          { type: "system", text: "‚ö†Ô∏è This person is pressuring you. Real friends don't use guilt to get photos." }
        ],
        actions: [
          { label: "üì∏ Send a photo", type: "bad", feedback: { title: "üö® STOP!", text: "You should NEVER feel pressured to send photos. Using guilt ('it's only fair', 'you don't trust me') is manipulation. Promises that 'no one else will see it' cannot be guaranteed.", mood: "bad" }},
          { label: "üö´ Say NO", type: "good", feedback: { title: "‚úÖ Absolutely right!", text: "You always have the right to say no. A response like 'No, I'm not comfortable with that' is perfectly okay. Anyone who doesn't respect your 'no' is not a real friend.", mood: "good" }},
          { label: "üö´ Block and tell an adult", type: "good", feedback: { title: "üåü The safest choice!", text: "If someone pressures you for photos, blocking them and telling a trusted adult is the best action. You deserve to feel safe.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Real friends never use guilt or pressure to get photos. 'If you don't‚Ä¶' is a manipulation tactic."
      }
    ],
    debrief: { happened: "Someone used guilt and promises to pressure you into sending a photo.", matters: "No one should ever pressure you to send photos. Guilt-tripping ('it's only fair') is manipulation. Sharing intimate images of people under 18 is a crime in Australia, even if both people are under 18.", nextTime: "You always have the right to say no. Block anyone who pressures you. Tell a trusted adult immediately. Remember: your body, your choice, your safety." },
    practice: [
      { q: "'It's only fair' is an example of‚Ä¶", opts: ["Fair reasoning", "Guilt-tripping manipulation", "A polite request", "Good friendship"], correct: 1, explain: "Using 'fairness' as pressure is a manipulation tactic. You never owe anyone a photo." },
      { q: "'If you don't, I'll think you don't trust me.' This is‚Ä¶", opts: ["A reasonable concern", "Emotional blackmail to make you feel guilty", "A sign of a good friend", "Nothing to worry about"], correct: 1, explain: "Using trust as leverage is emotional manipulation. Real trust means respecting someone's 'no'." },
      { q: "True or false: If someone sends you a photo, you must send one back.", opts: ["True ‚Äî it's rude not to", "False ‚Äî you never owe anyone a photo of yourself"], correct: 1, explain: "You never owe anyone a photo. Sending a photo is always your choice, never an obligation." },
      { q: "In Australia, sharing intimate images of someone under 18 is‚Ä¶", opts: ["Normal", "A criminal offence", "Only wrong for adults", "Allowed between friends"], correct: 1, explain: "Creating, sharing, or possessing intimate images of minors is a criminal offence in Australia." },
      { q: "'No one else will ever see it.' Can you trust this promise?", opts: ["Yes ‚Äî they promised", "No ‚Äî once sent, you lose all control of a digital image", "Yes ‚Äî if they're your friend", "Yes ‚Äî WhatsApp is private"], correct: 1, explain: "Once any digital image is sent, it can be screenshotted, forwarded, or leaked. Promises cannot guarantee privacy." },
      { q: "A real friend would‚Ä¶", opts: ["Pressure you until you agree", "Respect your 'no' without making you feel guilty", "Say 'it's only fair'", "Get angry if you refuse"], correct: 1, explain: "Real friends respect your boundaries without question or guilt-tripping." },
      { q: "If someone won't stop pressuring you for photos, you should‚Ä¶", opts: ["Give in to make them stop", "Block them, save evidence, and tell a trusted adult", "Send them someone else's photo instead", "Delete the conversation and forget about it"], correct: 1, explain: "Block, save evidence, and tell an adult. Persistent pressure is harassment." },
      { q: "What does 'consent' mean regarding photos?", opts: ["Taking a photo of anyone you want", "Freely choosing to share without pressure, and being able to say no at any time", "Sending photos when asked", "Agreeing because someone insists"], correct: 1, explain: "True consent is freely given, reversible, informed, enthusiastic, and specific. Any pressure removes consent." },
      { q: "If a photo you sent is shared without your consent, it's‚Ä¶", opts: ["Your fault for sending it", "NOT your fault ‚Äî the person who shared it is responsible", "Too late to do anything", "Just a mistake"], correct: 1, explain: "The person who shares without consent is responsible. Contact the eSafety Commissioner for help." },
      { q: "Where can you get help if intimate images are shared?", opts: ["Nowhere", "The eSafety Commissioner, police, Kids Helpline, or a trusted adult", "Only social media platforms", "Only your friends"], correct: 1, explain: "The eSafety Commissioner (esafety.gov.au), police, Kids Helpline (1800 55 1800), and trusted adults can all help." }
    ]
  },
  { id: 18, title: "Hate Speech / Targeting Identity", tag: "Inclusion",
    groupName: "School Social ‚ú®", members: "You, Daniel, Amira, Chris, Suki, Marcus", avatar: "üè≥Ô∏è‚Äçüåà",
    goals: ["I can recognise hate speech that targets someone's identity.", "I can stand up against discrimination and support the person targeted.", "I know that hate speech is against the law and school policies."],
    steps: [
      { chat: [
          { sender: "Daniel", text: "Amira why do you always wear that thing on your head üôÑ", time: "3:00 pm" },
          { sender: "Chris", text: "yeah it looks weird tbh", time: "3:00 pm" },
          { sender: "Suki", text: "That's not ok to say‚Ä¶", time: "3:01 pm" },
          { sender: "Daniel", text: "Relax it's just a question ü§∑", time: "3:01 pm" },
          { type: "system", text: "Amira wears a hijab as part of her religious and cultural identity. The comments are targeting her identity." }
        ],
        actions: [
          { label: "üòÇ Join in", type: "bad", feedback: { title: "üö® That's hate speech!", text: "Making fun of someone's religion, culture, appearance, or identity is hate speech. It's against school rules and may be against the law. These comments can cause deep hurt.", mood: "bad" }},
          { label: "üí¨ Support Suki ‚Äî say it's not ok", type: "good", feedback: { title: "üåü Standing up matters!", text: "Agreeing with Suki sends a clear message that targeting someone's identity is wrong. You could say: 'Suki's right. Amira's hijab is part of who she is and it deserves respect.'", mood: "good" }},
          { label: "üì± Message Amira privately", type: "good", feedback: { title: "üëç Kind and supportive!", text: "A private message of support like 'I'm sorry about those comments ‚Äî that wasn't okay' shows Amira she's not alone.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Making fun of someone's religious or cultural identity is hate speech. How would you want others to respond if it was about you?"
      }
    ],
    debrief: { happened: "Group members made hurtful comments about Amira's hijab, targeting her religious and cultural identity.", matters: "Hate speech targets people based on their identity ‚Äî religion, race, culture, gender, sexuality, disability, or appearance. It causes real harm and is against the law.", nextTime: "Call it out respectfully. Support the person targeted. Report hate speech. Tell a trusted adult. Remember: everyone deserves to feel safe and respected for who they are." },
    practice: [
      { q: "What is hate speech?", opts: ["Any speech someone doesn't like", "Speech that attacks a person based on their identity (religion, race, gender, etc.)", "Swearing", "Loud talking"], correct: 1, explain: "Hate speech specifically targets someone's identity ‚Äî who they are ‚Äî not just any disagreement." },
      { q: "Daniel says 'it's just a question.' Is targeting someone's religious clothing 'just a question'?", opts: ["Yes ‚Äî curiosity is fine", "No ‚Äî the mocking tone and context make it harmful, not curious", "Maybe ‚Äî depends on the answer", "Yes ‚Äî if no swear words"], correct: 1, explain: "The context and mocking tone make it clear this isn't genuine curiosity but targeted harassment." },
      { q: "Suki says 'That's not ok.' How can you support her?", opts: ["Tell Suki to mind her business", "Agree with her and reinforce the message", "Stay silent", "Change the subject"], correct: 1, explain: "Supporting someone who speaks up amplifies the message and shows the group that discrimination is unacceptable." },
      { q: "Why is it important to stand up against hate speech?", opts: ["It's not important", "Because silence allows it to continue and grow", "Only teachers should deal with it", "It's only important for adults"], correct: 1, explain: "Silence can be interpreted as acceptance. Speaking up helps create a culture of respect and inclusion." },
      { q: "Hate speech can target someone's‚Ä¶", opts: ["Only their race", "Religion, race, culture, gender, sexuality, disability, or appearance", "Only their personality", "Only what they wear"], correct: 1, explain: "Hate speech can target any aspect of someone's identity ‚Äî it's about who they are, not just what they do." },
      { q: "True or false: Hate speech is 'just words' and doesn't cause real harm.", opts: ["True ‚Äî words can't hurt", "False ‚Äî hate speech causes real emotional, psychological, and social harm"], correct: 1, explain: "Research shows hate speech causes significant emotional and psychological harm and can lead to physical consequences." },
      { q: "In Australia, some forms of hate speech are‚Ä¶", opts: ["Totally fine", "Against the law under the Racial Discrimination Act and other legislation", "Only a school issue", "Encouraged"], correct: 1, explain: "Australia has laws against hate speech, including the Racial Discrimination Act." },
      { q: "If Amira seems upset but says she's fine, you could‚Ä¶", opts: ["Take her at her word and move on", "Gently offer support and let her know you're there if she changes her mind", "Tell everyone she's upset", "Ignore her"], correct: 1, explain: "People sometimes say they're fine when they're not. Gentle, private support leaves the door open." },
      { q: "What should a teacher or school do about hate speech in a group chat?", opts: ["Nothing ‚Äî it's outside school", "Address it because it affects school wellbeing, even if it happened online", "Punish everyone in the group", "Ignore online behaviour"], correct: 1, explain: "Schools have a responsibility to address behaviour that affects student wellbeing, even if it occurs online." },
      { q: "How can you create a group chat culture that prevents hate speech?", opts: ["Avoid talking about differences", "Set group rules about respect and call out discrimination when it happens", "Remove anyone who's different", "Only add people who are similar"], correct: 1, explain: "Clear group expectations about respect, combined with willingness to call out discrimination, create safer spaces." }
    ]
  },
  { id: 19, title: "Rumours Spread Fast", tag: "Kindness",
    groupName: "Year Level Chat üì£", members: "You, Tara, Ben, Lucy, Omar, Ash", avatar: "üó£Ô∏è",
    goals: ["I can understand how quickly rumours spread in group chats.", "I know not to forward unverified information about other people.", "I can stop a rumour by not sharing it and by speaking up."],
    steps: [
      { chat: [
          { sender: "Tara", text: "Did you hear that Lucy and Omar are going out?! üò±", time: "12:30 pm" },
          { sender: "Ben", text: "NO WAY!! Who told you?!", time: "12:30 pm" },
          { sender: "Tara", text: "Someone told someone who told me ü§∑‚Äç‚ôÄÔ∏è", time: "12:31 pm" },
          { sender: "Ash", text: "Should we ask them? Or just spread the word lol", time: "12:31 pm" },
          { type: "system", text: "This rumour may not be true. Lucy and Omar don't know it's being discussed." }
        ],
        actions: [
          { label: "üì¢ Spread it", type: "bad", feedback: { title: "‚ö†Ô∏è Stop the spread!", text: "Sharing unverified information about other people can hurt them deeply. This rumour has already passed through multiple people ‚Äî it may not even be true.", mood: "bad" }},
          { label: "üõë Say we shouldn't spread it", type: "good", feedback: { title: "üëç Respectful!", text: "Saying 'We shouldn't spread rumours about people ‚Äî it's not fair to Lucy or Omar' shows maturity and respect. You're breaking the chain.", mood: "good" }},
          { label: "ü§´ Don't share it yourself", type: "caution", feedback: { title: "üëç Good start, but‚Ä¶", text: "Not sharing the rumour yourself is good. But speaking up to stop others from spreading it too would be even better.", mood: "caution" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "'Someone told someone who told me' ‚Äî how many times has this story changed?"
      }
    ],
    debrief: { happened: "A rumour about two classmates spread through the group chat without being verified.", matters: "Rumours spread incredibly fast in group chats. By the time they reach you, they may have changed completely. Spreading unverified information can damage reputations and hurt feelings.", nextTime: "Don't forward rumours. Ask yourself: 'Is this true? Is it kind? Is it necessary?' If you can't answer yes to all three, don't share it." },
    practice: [
      { q: "'Someone told someone who told me' is a sign that this information is‚Ä¶", opts: ["Definitely true", "Unverified and possibly inaccurate", "From a reliable source", "Official news"], correct: 1, explain: "Information that's been passed through multiple people is unreliable ‚Äî like a game of telephone." },
      { q: "Before sharing something about another person, ask yourself‚Ä¶", opts: ["'Will this get likes?'", "'Is it true? Is it kind? Is it necessary?'", "'Will people think I'm cool?'", "'Is it juicy gossip?'"], correct: 1, explain: "The triple filter ‚Äî true, kind, necessary ‚Äî helps you decide whether sharing is the right thing to do." },
      { q: "How fast can a rumour spread in a group chat?", opts: ["Slowly ‚Äî people check facts first", "Almost instantly ‚Äî one forward can reach hundreds", "It can't spread past the group", "Only if people believe it"], correct: 1, explain: "In group chats with many members, a single forward can spread information to hundreds of people in minutes." },
      { q: "Lucy finds out the group is spreading a rumour about her. She probably feels‚Ä¶", opts: ["Flattered", "Embarrassed, hurt, and betrayed", "Proud", "Nothing"], correct: 1, explain: "Being the subject of rumours is hurtful and embarrassing, especially when you can't control the narrative." },
      { q: "The best way to stop a rumour is to‚Ä¶", opts: ["Forward it with a 'don't tell anyone' disclaimer", "Not share it, and tell others to stop sharing it too", "Add to it to make it more interesting", "Screenshot it for evidence"], correct: 1, explain: "Rumours die when people stop sharing them. Be the one who breaks the chain." },
      { q: "True or false: If a rumour turns out to be true, it was okay to spread it.", opts: ["True ‚Äî truth is truth", "False ‚Äî it's still not your information to share without the person's consent"], correct: 1, explain: "Even true information about someone's private life shouldn't be shared without their consent." },
      { q: "Ash asks 'Should we ask them or just spread the word?' What's the right answer?", opts: ["Spread the word ‚Äî it's exciting", "Neither ‚Äî don't spread it, and don't put Lucy and Omar on the spot either", "Ask them publicly in the chat", "Create a poll"], correct: 1, explain: "The respectful choice is to not spread it and not put people on the spot about their private lives." },
      { q: "How might rumours affect someone's mental health?", opts: ["They don't ‚Äî it's just words", "Rumours can cause anxiety, depression, social isolation, and trust issues", "Only if the person is sensitive", "They can't ‚Äî people get over it"], correct: 1, explain: "Rumours can significantly impact mental health, causing anxiety, depression, and social withdrawal." },
      { q: "If a rumour is being spread about YOU, what should you do?", opts: ["Spread a rumour about someone else", "Talk to a trusted adult and ask friends to stop sharing it", "Send angry messages to everyone", "Leave all groups forever"], correct: 1, explain: "Talk to a trusted adult who can help address the situation and ask friends to stop spreading it." },
      { q: "What's the difference between sharing news and spreading rumours?", opts: ["Nothing ‚Äî they're the same", "News is verified fact; rumours are unverified and potentially harmful", "Rumours are more fun", "News is boring, rumours are exciting"], correct: 1, explain: "News is verified and factual. Rumours are unverified, potentially false, and can cause harm." }
    ]
  },
  { id: 20, title: "Location Sharing Risks", tag: "Privacy",
    groupName: "Hangout Crew üèñÔ∏è", members: "You, Zoe, Ethan, Maya, Lucas", avatar: "üìç",
    goals: ["I can understand the risks of sharing my location.", "I know to check my privacy settings and be careful about live location.", "I can recognise when location sharing might be unsafe."],
    steps: [
      { chat: [
          { sender: "Ethan", text: "Where is everyone?? Share your live location so we can find each other!", time: "2:00 pm" },
          { sender: "Maya", text: "Good idea! *shared live location*", time: "2:01 pm" },
          { sender: "Zoe", text: "Hmm should we share live location in a group though? Anyone could see it", time: "2:01 pm" },
          { type: "system", text: "Live location shows exactly where you are in real time for up to 8 hours." }
        ],
        actions: [
          { label: "üìç Share live location", type: "caution", feedback: { title: "‚ö†Ô∏è Think first!", text: "Live location shows your exact position in real time. In a group chat, anyone in the group (and anyone looking at their phone) can see where you are. Consider sharing via private message instead.", mood: "caution" }},
          { label: "ü§î Agree with Zoe", type: "good", feedback: { title: "üëç Smart thinking!", text: "Zoe is right to question sharing live location in a group. It's safer to share location privately with specific people you trust, and only when necessary.", mood: "good" }},
          { label: "üì± Send location privately instead", type: "good", feedback: { title: "‚úÖ Best approach!", text: "Sharing your location in a private message to one trusted friend is much safer than broadcasting it to a whole group.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "Live location shows your exact position for hours. Who in this group can see it? Is everyone trustworthy?"
      }
    ],
    debrief: { happened: "The group asked everyone to share live location, which broadcasts your exact position in real time.", matters: "Location sharing can reveal where you are, where you live, and your daily routine. This information could be misused by someone with bad intentions.", nextTime: "Only share location with specific trusted people via private message. Turn off live location when no longer needed. Check your privacy settings regularly." },
    practice: [
      { q: "Live location on WhatsApp shows‚Ä¶", opts: ["Your general city", "Your exact real-time position for up to 8 hours", "Only your suburb", "Nothing ‚Äî it's just a pin on a map"], correct: 1, explain: "Live location continuously updates your exact position, making it a powerful but risky feature." },
      { q: "Why is sharing location in a GROUP chat riskier than a private message?", opts: ["It's not riskier", "More people can see it, including anyone who has access to group members' phones", "Group chats are more fun", "Groups are safer because there are more people"], correct: 1, explain: "In a group, everyone (plus anyone looking at their phones) can see your exact location." },
      { q: "What could someone with bad intentions do with your live location?", opts: ["Nothing harmful", "Find where you are, follow you, or figure out your home/school", "Send you emojis", "Add you to a group"], correct: 1, explain: "Location data can be used to track your movements, find your home, or determine your routine." },
      { q: "A safer way to share your location with a friend is to‚Ä¶", opts: ["Share in a group so everyone can see", "Send it privately to just that friend, and turn it off when you've met up", "Post it on social media", "Shout it out loud"], correct: 1, explain: "Private sharing with one trusted person, turned off once you've met, is the safest approach." },
      { q: "How often should you check your location sharing settings?", opts: ["Never", "Regularly ‚Äî to make sure you're not sharing location with anyone unintended", "Only when you get a new phone", "Once a year"], correct: 1, explain: "Regular checks ensure you haven't accidentally left location sharing on or shared it with unintended people." },
      { q: "Zoe questions sharing location in the group. She is being‚Ä¶", opts: ["Paranoid", "Sensible and safety-conscious", "Annoying", "Unhelpful"], correct: 1, explain: "Questioning safety practices is sensible, not paranoid. Zoe is helping the group make safer choices." },
      { q: "True or false: If you trust everyone in the group, sharing live location is completely safe.", opts: ["True ‚Äî trusted friends are fine", "False ‚Äî phones can be seen by others, and group memberships can change"], correct: 1, explain: "Even in trusted groups, others might see members' phones, or someone new might be added." },
      { q: "What information can someone figure out from your location history?", opts: ["Nothing useful", "Where you live, go to school, and your daily routine", "Only where you are right now", "Your phone number"], correct: 1, explain: "Regular location sharing reveals patterns: your home, school, activities, and daily schedule." },
      { q: "If you accidentally shared your location and want to stop, you should‚Ä¶", opts: ["Wait for it to expire", "Stop sharing immediately through WhatsApp settings", "Turn off your phone", "Throw your phone away"], correct: 1, explain: "You can stop sharing live location at any time through the chat or WhatsApp settings." },
      { q: "Photos can also reveal your location through‚Ä¶", opts: ["Magic", "Metadata/EXIF data that contains GPS coordinates", "The background", "The filters used"], correct: 1, explain: "Photos often contain metadata including GPS coordinates. Be aware of this when sharing photos." }
    ]
  },
  { id: 21, title: "Who Can See My Info? (Privacy Settings)", tag: "Privacy",
    groupName: "Settings Check ‚öôÔ∏è", members: "You", avatar: "üëÅÔ∏è",
    goals: ["I can navigate WhatsApp privacy settings.", "I understand what each privacy setting controls.", "I can set my privacy to the safest levels."],
    steps: [
      { chat: [
          { type: "system", text: "Let's check your WhatsApp privacy settings! Do you know who can see your profile photo, status, and last seen?" },
          { sender: "Safety Guide", text: "Many people leave their settings on 'Everyone' without realising strangers can see their information.", time: "Now" },
          { sender: "Safety Guide", text: "Let's go through the key settings together! üîí", time: "Now" }
        ],
        actions: [
          { label: "üëÄ Check who sees my photo", type: "good", feedback: { title: "‚úÖ Great start!", text: "Your profile photo should be set to 'My contacts' or 'Nobody'. When set to 'Everyone', any person on WhatsApp ‚Äî even strangers ‚Äî can see your photo.", mood: "good" }},
          { label: "üïê Check Last Seen", type: "good", feedback: { title: "‚úÖ Important one!", text: "'Last seen' tells people when you were last online. Set it to 'My contacts' or 'Nobody' to prevent strangers from tracking when you're active.", mood: "good" }},
          { label: "üë• Check Groups setting", type: "good", feedback: { title: "‚úÖ Key safety setting!", text: "Set Groups to 'My contacts' so only people in your phone book can add you to groups. This prevents random spam groups and scam invitations.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "All choices are good here! Let's learn about each privacy setting."
      }
    ],
    debrief: { happened: "We reviewed WhatsApp privacy settings that control who can see your information.", matters: "Privacy settings are your first line of defence. Setting them correctly prevents strangers from seeing your photo, tracking your activity, or adding you to random groups.", nextTime: "Regularly check Settings ‚Üí Privacy and ensure: Profile photo = My contacts, Last seen = My contacts, About = My contacts, Groups = My contacts. Enable two-step verification for account security." },
    practice: [
      { q: "Where do you find WhatsApp privacy settings?", opts: ["In the chat", "Settings ‚Üí Privacy", "By asking a friend", "You can't change them"], correct: 1, explain: "Go to Settings (or the three dots menu) ‚Üí Privacy to find all your privacy controls." },
      { q: "Your profile photo is set to 'Everyone'. This means‚Ä¶", opts: ["Only your friends see it", "Any person on WhatsApp, including strangers, can see your photo", "No one can see it", "Only your family"], correct: 1, explain: "The 'Everyone' setting makes your photo visible to all WhatsApp users, not just your contacts." },
      { q: "What's the safest setting for 'Last Seen'?", opts: ["Everyone", "My contacts or Nobody", "Only strangers", "It doesn't matter"], correct: 1, explain: "'My contacts' or 'Nobody' prevents strangers from knowing when you're active on WhatsApp." },
      { q: "The 'Groups' privacy setting should be set to‚Ä¶", opts: ["Everyone ‚Äî more groups are fun", "'My contacts' ‚Äî so only people you know can add you to groups", "Nobody ‚Äî no groups ever", "It doesn't matter"], correct: 1, explain: "'My contacts' ensures only people in your address book can add you to groups, blocking spam and scam groups." },
      { q: "Two-step verification adds‚Ä¶", opts: ["A second phone", "A personal PIN required when registering your phone number with WhatsApp", "More emojis", "Faster messaging"], correct: 1, explain: "Two-step verification adds a PIN that protects your account even if someone gets your verification code." },
      { q: "Why should you check your privacy settings regularly?", opts: ["To find new features", "Settings can reset after updates, and your needs may change", "To change your profile picture", "You don't need to check them"], correct: 1, explain: "App updates can sometimes reset settings, and your privacy needs may evolve over time." },
      { q: "True or false: Default WhatsApp settings are the safest option.", opts: ["True ‚Äî WhatsApp sets the safest defaults", "False ‚Äî default settings are often set to 'Everyone' and need to be changed"], correct: 1, explain: "Many default settings are less restrictive. You should actively adjust them for maximum privacy." },
      { q: "If you set 'About' to 'Nobody', then‚Ä¶", opts: ["No one can message you", "No one can see your status text (about section)", "You can't use WhatsApp", "Nothing changes"], correct: 1, explain: "Setting 'About' to 'Nobody' hides your status text from all users, adding an extra layer of privacy." },
      { q: "What information can strangers see if your privacy settings are all set to 'Everyone'?", opts: ["Nothing", "Your profile photo, last seen time, about text, and they can add you to groups", "Only your name", "Only your phone number"], correct: 1, explain: "With all settings on 'Everyone', strangers can see your photo, activity times, status, and add you to groups." },
      { q: "The MOST important privacy action you can take right now is to‚Ä¶", opts: ["Delete WhatsApp", "Go to Settings ‚Üí Privacy and change everything from 'Everyone' to 'My contacts'", "Change your profile picture", "Send a message about privacy"], correct: 1, explain: "Changing privacy settings from 'Everyone' to 'My contacts' is the single most impactful step you can take." }
    ]
  },
  { id: 22, title: '"School Stuff" vs "After Hours"', tag: "Boundaries",
    groupName: "Project Group üìê", members: "You, Ava, Tom, Nadia, Kofi", avatar: "üïê",
    goals: ["I can set healthy boundaries around when and how I use group chats.", "I can recognise when chat behaviour is becoming unhealthy or stressful.", "I know it's okay to mute, leave, or take breaks from group chats."],
    steps: [
      { chat: [
          { sender: "Tom", text: "GUYS the homework is due tomorrow!!! What's the answer to Q5?!!", time: "10:30 pm" },
          { sender: "Ava", text: "It's 10:30pm Tom üò¥", time: "10:31 pm" },
          { sender: "Nadia", text: "I was already asleep!! üò°", time: "10:32 pm" },
          { sender: "Tom", text: "Come on PLEASE someone help me!! I'll fail!!", time: "10:32 pm" },
          { sender: "Kofi", text: "Maybe do your homework earlier next time? ü§∑", time: "10:33 pm" }
        ],
        actions: [
          { label: "üìù Help Tom with the answer", type: "caution", feedback: { title: "ü§î Kind but think about boundaries!", text: "Helping is nice, but responding to late-night homework requests sets a pattern. It's okay to say: 'I'll help tomorrow before school.' Setting boundaries protects your sleep and wellbeing.", mood: "caution" }},
          { label: "üîá Mute the chat", type: "good", feedback: { title: "üëç Protecting your rest!", text: "Muting the chat at night is a healthy boundary. You can check messages in the morning. Your sleep matters.", mood: "good" }},
          { label: "üí¨ Say 'Let's talk about this tomorrow'", type: "good", feedback: { title: "‚úÖ Healthy boundary!", text: "Redirecting to a better time is respectful and firm. You could say: 'Can't help right now ‚Äî let's sort it before school.' This teaches everyone that late-night chat has limits.", mood: "good" }},
          { label: "üõ°Ô∏è Open help", type: "help" }
        ],
        hint: "It's 10:30pm. Is this a reasonable time to be messaging your group about homework?"
      }
    ],
    debrief: { happened: "A group member sent stressful messages late at night about homework, disrupting everyone's sleep.", matters: "Group chats don't have 'off' buttons unless you set them. Late-night messaging can disrupt sleep, increase anxiety, and create pressure to always be available.", nextTime: "Set boundaries: mute chats at bedtime, agree on 'no message' hours with your group, and know it's okay to reply later. Your wellbeing comes before a WhatsApp notification." },
    practice: [
      { q: "Tom messages the group at 10:30pm about homework. This is an example of‚Ä¶", opts: ["Good planning", "Poor boundaries around group chat timing", "An emergency", "Normal behaviour"], correct: 1, explain: "Late-night homework panic in a group chat disrupts everyone's rest and isn't respectful of boundaries." },
      { q: "What's a healthy group chat boundary to set?", opts: ["Always respond immediately", "Agree on 'quiet hours' ‚Äî no messages after a certain time", "Never turn off notifications", "Check messages every 5 minutes"], correct: 1, explain: "Agreeing on quiet hours helps everyone protect their sleep and reduces pressure to be constantly available." },
      { q: "Muting a group chat at night is‚Ä¶", opts: ["Rude", "A healthy choice that protects your sleep and wellbeing", "Only for adults", "Ignoring your friends"], correct: 1, explain: "Muting is a built-in feature designed to help you manage your attention and rest." },
      { q: "True or false: You must reply to group chat messages immediately.", opts: ["True ‚Äî being a good friend means instant replies", "False ‚Äî you can reply when it suits you, and that's completely okay"], correct: 1, explain: "There is no obligation to reply immediately. Your time and rest are important." },
      { q: "If group chats are making you feel stressed or anxious, you should‚Ä¶", opts: ["Just deal with it", "Talk to a trusted adult and consider taking a break from the chat", "Message more to feel better", "Create more group chats"], correct: 1, explain: "If chats are affecting your wellbeing, talk to a trusted adult. Taking breaks from chats is healthy." },
      { q: "Ava says 'It's 10:30pm.' She is setting a‚Ä¶", opts: ["Bad example", "Healthy boundary about appropriate messaging times", "Trap", "Joke"], correct: 1, explain: "Ava is reminding the group that late-night messaging isn't appropriate ‚Äî that's a healthy boundary." },
      { q: "What does 'fear of missing out' (FOMO) mean in group chats?", opts: ["A type of emoji", "Anxiety about missing messages or conversations if you're not constantly checking", "A new app feature", "Being left out of a group"], correct: 1, explain: "FOMO is the anxiety that something important will happen while you're offline. It can lead to unhealthy phone habits." },
      { q: "How can you help a friend who seems stressed about group chats?", opts: ["Add them to more groups", "Suggest they mute, take breaks, or talk to a trusted adult", "Tell them to grow up", "Ignore them"], correct: 1, explain: "Supporting friends in setting healthy boundaries shows you care about their wellbeing, not just the chat." },
      { q: "It's okay to leave a group chat if‚Ä¶", opts: ["Never ‚Äî that's rude", "The chat is causing you stress, anxiety, or you simply don't want to be in it", "Only if a teacher says so", "Only if everyone agrees"], correct: 1, explain: "You always have the right to leave a group that doesn't serve your wellbeing. You don't need permission." },
      { q: "A healthy relationship with group chats includes‚Ä¶", opts: ["Checking every 2 minutes", "Setting boundaries, muting when needed, and not feeling guilty about not replying instantly", "Never leaving any group", "Replying to everything immediately"], correct: 1, explain: "Healthy digital habits include boundaries, breaks, and understanding that your worth isn't tied to your response time." }
    ]
  }
);


// ============================================================
// ENGINE
// ============================================================
let currentLesson = null;
let currentStep = 0;
let score = 0;
let totalSteps = 0;
let easyRead = false;
let reduceClutter = false;
let practiceAnswers = []; // Track answers for PDF worksheet

// Sender colours
const SENDER_COLORS = ["#075E54","#128C7E","#25D366","#00A884","#4CAF50","#009688","#2196F3","#673AB7","#E91E63","#FF5722"];
function colorForSender(name) {
  let hash = 0;
  for (let i = 0; i < name.length; i++) hash = name.charCodeAt(i) + ((hash << 5) - hash);
  return SENDER_COLORS[Math.abs(hash) % SENDER_COLORS.length];
}

// Build TOC
function buildTOC() {
  const grid = document.getElementById('tocGrid');
  grid.innerHTML = '';
  const allLessons = [...LESSONS];
  // Fill remaining skeleton lessons that aren't in LESSONS
  LESSON_SKELETONS.forEach(sk => {
    if (!allLessons.find(l => l.id === sk.id)) {
      allLessons.push(sk);
    }
  });
  allLessons.sort((a, b) => a.id - b.id);

  allLessons.forEach(lesson => {
    const card = document.createElement('div');
    card.className = 'toc-card';
    card.tabIndex = 0;
    card.setAttribute('role', 'button');
    card.setAttribute('aria-label', `Lesson ${lesson.id}: ${lesson.title}`);
    const hasContent = LESSONS.find(l => l.id === lesson.id);
    card.innerHTML = `
      <span class="toc-num">${lesson.id}</span>
      <span class="toc-label">${lesson.title}</span>
      <span class="toc-tag">${lesson.tag || ''}</span>
    `;
    card.onclick = () => {
      if (hasContent) startLesson(lesson.id);
    };
    card.onkeydown = (e) => { if (e.key === 'Enter') card.click(); };
    if (!hasContent) {
      card.style.opacity = '0.5';
      card.title = 'Coming soon';
    }
    grid.appendChild(card);
  });
}

// Start lesson
function startLesson(id) {
  currentLesson = LESSONS.find(l => l.id === id);
  if (!currentLesson) return;
  currentStep = 0;
  score = 0;
  totalSteps = currentLesson.steps.length;

  document.getElementById('splash').style.display = 'none';
  const sim = document.getElementById('sim-container');
  sim.classList.add('active');

  document.getElementById('groupName').textContent = currentLesson.groupName;
  document.getElementById('groupMembers').textContent = currentLesson.members;
  document.getElementById('groupAvatar').textContent = currentLesson.avatar;
  document.getElementById('debriefCard').classList.remove('show');
  document.getElementById('practiceContainer').classList.remove('show');
  document.getElementById('practiceContainer').innerHTML = '';

  renderStep();
  window.scrollTo(0, 0);
}

// Render step
function renderStep() {
  if (!currentLesson || currentStep >= currentLesson.steps.length) {
    showDebrief();
    return;
  }
  const step = currentLesson.steps[currentStep];
  const chatArea = document.getElementById('chatArea');
  const actionBar = document.getElementById('actionBar');
  const feedbackPanel = document.getElementById('feedbackPanel');

  // Update score & step
  document.getElementById('starsDisplay').textContent = `‚≠ê ${score}`;
  document.getElementById('stepIndicator').textContent = `Step ${currentStep + 1} of ${totalSteps}`;

  // Flash safety button on first step
  const safetyBtn = document.getElementById('safetyBtn');
  if (currentStep === 0) safetyBtn.classList.add('flash');
  else safetyBtn.classList.remove('flash');

  // Hide feedback
  feedbackPanel.classList.remove('show', 'good', 'caution', 'bad');

  // Build chat
  chatArea.innerHTML = '';
  // Date divider
  const dateDiv = document.createElement('div');
  dateDiv.className = 'chat-date';
  dateDiv.textContent = 'Today';
  chatArea.appendChild(dateDiv);

  step.chat.forEach((msg, i) => {
    setTimeout(() => {
      if (msg.type === 'system') {
        const el = document.createElement('div');
        el.className = 'system-msg';
        el.textContent = msg.text;
        chatArea.appendChild(el);
      } else if (msg.type === 'video') {
        const row = document.createElement('div');
        row.className = 'bubble-row incoming';
        row.innerHTML = `
          <div class="bubble-sender" style="color:${msg.senderColor || colorForSender(msg.sender || '')}">${msg.sender || ''}</div>
          <div class="bubble">
            ${msg.fwd ? `<div class="fwd-label">‚Ü™Ô∏è ${msg.fwd}</div>` : ''}
            <div class="video-thumb"><div class="play-circle">‚ñ∂</div></div>
            <div class="msg-text">${msg.caption || ''}</div>
            <div class="meta-row"><span>${msg.time || ''}</span></div>
          </div>
        `;
        chatArea.appendChild(row);
      } else if (msg.type === 'image') {
        const row = document.createElement('div');
        row.className = 'bubble-row incoming';
        row.innerHTML = `
          <div class="bubble-sender" style="color:${msg.senderColor || colorForSender(msg.sender || '')}">${msg.sender || ''}</div>
          <div class="bubble">
            <div class="img-placeholder">üì∑ [Image placeholder]</div>
            <div class="msg-text">${msg.caption || ''}</div>
            <div class="meta-row"><span>${msg.time || ''}</span></div>
          </div>
        `;
        chatArea.appendChild(row);
      } else {
        const row = document.createElement('div');
        row.className = `bubble-row incoming`;
        row.innerHTML = `
          <div class="bubble-sender" style="color:${msg.senderColor || colorForSender(msg.sender || '')}">${msg.sender || ''}</div>
          <div class="bubble">
            ${msg.fwd ? `<div class="fwd-label">‚Ü™Ô∏è ${msg.fwd}</div>` : ''}
            <div class="msg-text">${msg.text}</div>
            <div class="meta-row"><span>${msg.time || ''}</span></div>
          </div>
        `;
        chatArea.appendChild(row);
      }
      chatArea.scrollTop = chatArea.scrollHeight;
    }, i * 400);
  });

  // Build action buttons
  setTimeout(() => {
    actionBar.innerHTML = '';
    step.actions.forEach(action => {
      const btn = document.createElement('button');
      btn.className = 'action-btn';
      if (action.type === 'bad') btn.classList.add('danger');
      else if (action.type === 'caution') btn.classList.add('warning');
      else if (action.type === 'good') btn.classList.add('safe');
      btn.textContent = action.label;
      btn.onclick = () => handleAction(action);
      actionBar.appendChild(btn);
    });
  }, step.chat.length * 400 + 200);
}

// Handle action
function handleAction(action) {
  if (action.type === 'help') {
    toggleHelp();
    return;
  }

  const feedbackPanel = document.getElementById('feedbackPanel');
  feedbackPanel.classList.remove('show', 'good', 'caution', 'bad');

  // Score
  if (action.type === 'good') score += 2;
  else if (action.type === 'caution') score += 1;
  document.getElementById('starsDisplay').textContent = `‚≠ê ${score}`;

  // Show feedback
  setTimeout(() => {
    feedbackPanel.classList.add('show', action.feedback.mood);
    document.getElementById('feedbackTitle').textContent = action.feedback.title;
    document.getElementById('feedbackText').textContent = action.feedback.text;

    if (action.type === 'bad') {
      document.getElementById('feedbackRetry').style.display = 'inline-block';
    } else {
      document.getElementById('feedbackRetry').style.display = 'none';
    }

    // Disable action buttons
    document.querySelectorAll('.action-btn').forEach(btn => {
      btn.disabled = true;
      btn.style.opacity = 0.5;
    });

    feedbackPanel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }, 100);
}

function nextStep() {
  currentStep++;
  renderStep();
  document.getElementById('chatArea').scrollTop = 0;
}

function retryStep() {
  renderStep();
}

// Debrief
function showDebrief() {
  document.getElementById('actionBar').innerHTML = '';
  document.getElementById('feedbackPanel').classList.remove('show');

  const card = document.getElementById('debriefCard');
  const content = document.getElementById('debriefContent');
  const d = currentLesson.debrief;

  content.innerHTML = `
    <div class="debrief-section">
      <h4>üìñ What Happened</h4>
      <p>${d.happened}</p>
    </div>
    <div class="debrief-section">
      <h4>üí° Why It Matters</h4>
      <p>${d.matters}</p>
    </div>
    <div class="debrief-section">
      <h4>‚úÖ What To Do Next Time</h4>
      <p>${d.nextTime}</p>
    </div>
    <div class="reminder-box">
      <span>üîî</span>
      <span>If something ever feels wrong, tell a trusted adult. You're never in trouble for asking for help.</span>
    </div>
    <p style="margin-top:12px;font-weight:700;text-align:center;">Your score: ‚≠ê ${score}</p>
  `;
  card.classList.add('show');
  card.scrollIntoView({ behavior: 'smooth' });
}

// Practice
function startPractice() {
  if (!currentLesson || !currentLesson.practice) return;
  document.getElementById('debriefCard').classList.remove('show');

  // Reset answer tracking
  practiceAnswers = currentLesson.practice.map(() => ({ selected: null, correct: false }));

  const container = document.getElementById('practiceContainer');
  container.innerHTML = `<h3 style="color:var(--wa-dark-green);margin-bottom:14px;">üìù Practice ‚Äì ${currentLesson.title}</h3>`;
  container.classList.add('show');

  // Student name input row
  const nameRow = document.createElement('div');
  nameRow.className = 'practice-name-row';
  const savedName = document.getElementById('studentNameInput') ? document.getElementById('studentNameInput').value : '';
  nameRow.innerHTML = `
    <label for="practiceNameInput">üë§ Student Name:</label>
    <input type="text" id="practiceNameInput" placeholder="Enter your name for the worksheet‚Ä¶" maxlength="60" value="${savedName.replace(/"/g, '&quot;')}" />
  `;
  container.appendChild(nameRow);

  // Sync name fields
  const practiceNameInput = nameRow.querySelector('#practiceNameInput');
  practiceNameInput.addEventListener('input', function() {
    const splash = document.getElementById('studentNameInput');
    if (splash) splash.value = this.value;
  });

  currentLesson.practice.forEach((pq, qi) => {
    const card = document.createElement('div');
    card.className = 'practice-q-card';
    card.innerHTML = `
      <div class="q-num">Question ${qi + 1} of ${currentLesson.practice.length}</div>
      <div class="q-text">${pq.q}</div>
      <div class="q-options" id="pq-opts-${qi}"></div>
      <div class="q-feedback" id="pq-fb-${qi}"></div>
    `;
    container.appendChild(card);

    const optsDiv = card.querySelector(`#pq-opts-${qi}`);
    pq.opts.forEach((opt, oi) => {
      const btn = document.createElement('button');
      btn.className = 'q-opt';
      btn.textContent = opt;
      btn.onclick = () => handlePractice(qi, oi);
      optsDiv.appendChild(btn);
    });
  });

  // Print button + navigation buttons
  const btns = document.createElement('div');
  btns.style.cssText = 'display:flex;gap:8px;margin-top:20px;justify-content:center;flex-wrap:wrap;';
  btns.innerHTML = `
    <button class="print-worksheet-btn" onclick="printWorksheet()">üñ®Ô∏è Print PDF Worksheet</button>
    <button class="finish-btn secondary" onclick="restartLesson()" style="padding:10px 20px;border-radius:12px;border:none;font-weight:700;cursor:pointer;font-family:inherit;">‚Ü∫ Redo Lesson</button>
    <button class="finish-btn primary" onclick="goHome()" style="padding:10px 20px;border-radius:12px;border:none;font-weight:700;cursor:pointer;font-family:inherit;background:var(--wa-dark-green);color:#fff;">üè† Menu</button>
  `;
  container.appendChild(btns);
  container.scrollIntoView({ behavior: 'smooth' });
}

function handlePractice(qi, selectedIdx) {
  const pq = currentLesson.practice[qi];
  const optsDiv = document.getElementById(`pq-opts-${qi}`);
  const fbDiv = document.getElementById(`pq-fb-${qi}`);
  const btns = optsDiv.querySelectorAll('.q-opt');

  btns.forEach((btn, i) => {
    btn.classList.add('disabled');
    if (i === pq.correct) btn.classList.add('correct');
    if (i === selectedIdx && i !== pq.correct) btn.classList.add('wrong');
  });

  const isCorrect = selectedIdx === pq.correct;
  fbDiv.className = `q-feedback show`;
  fbDiv.style.background = isCorrect ? 'var(--fb-good)' : 'var(--fb-bad)';
  fbDiv.innerHTML = `<strong>${isCorrect ? '‚úÖ Correct!' : '‚ùå Not quite.'}</strong> ${pq.explain}`;

  // Track answer for worksheet
  if (practiceAnswers[qi]) {
    practiceAnswers[qi].selected = selectedIdx;
    practiceAnswers[qi].correct = isCorrect;
    practiceAnswers[qi].selectedText = pq.opts[selectedIdx];
    practiceAnswers[qi].correctText = pq.opts[pq.correct];
  }
}

// Print PDF Worksheet
function printWorksheet() {
  if (!currentLesson || !currentLesson.practice) return;

  const nameInput = document.getElementById('practiceNameInput');
  const studentName = (nameInput ? nameInput.value.trim() : '') || 'Student';
  const totalQs = currentLesson.practice.length;
  const answered = practiceAnswers.filter(a => a.selected !== null).length;
  const correctCount = practiceAnswers.filter(a => a.correct).length;
  const today = new Date().toLocaleDateString('en-AU', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

  // Build question rows
  let questionsHTML = '';
  currentLesson.practice.forEach((pq, qi) => {
    const ans = practiceAnswers[qi];
    const wasAnswered = ans && ans.selected !== null;
    const wasCorrect = wasAnswered && ans.correct;
    const icon = !wasAnswered ? '‚¨ú' : wasCorrect ? '‚úÖ' : '‚ùå';
    const statusClass = !wasAnswered ? 'unanswered' : wasCorrect ? 'correct' : 'incorrect';

    questionsHTML += `
      <div class="ws-question ${statusClass}">
        <div class="ws-q-header">
          <span class="ws-q-num">${qi + 1}.</span>
          <span class="ws-q-icon">${icon}</span>
        </div>
        <div class="ws-q-body">
          <p class="ws-q-text">${pq.q}</p>
          <div class="ws-q-answer">
            <span class="ws-answer-label">Your answer:</span>
            <span class="ws-answer-text">${wasAnswered ? ans.selectedText : '<em>Not answered</em>'}</span>
          </div>
          ${wasAnswered && !wasCorrect ? `
          <div class="ws-q-correct">
            <span class="ws-answer-label">Correct answer:</span>
            <span class="ws-answer-text">${ans.correctText}</span>
          </div>` : ''}
          <div class="ws-q-explain">
            <strong>Why:</strong> ${pq.explain}
          </div>
        </div>
      </div>
    `;
  });

  // Build goals
  let goalsHTML = '';
  if (currentLesson.goals) {
    goalsHTML = currentLesson.goals.map(g => `<li>${g}</li>`).join('');
  }

  // Build debrief
  const d = currentLesson.debrief;
  const debriefHTML = d ? `
    <div class="ws-debrief">
      <h3>üìã Lesson Summary</h3>
      <p><strong>What happened:</strong> ${d.happened}</p>
      <p><strong>Why it matters:</strong> ${d.matters}</p>
      <p><strong>Next time:</strong> ${d.nextTime}</p>
    </div>
  ` : '';

  const printWindow = window.open('', '_blank');
  if (!printWindow) {
    alert('Please allow pop-ups to print the worksheet.');
    return;
  }

  printWindow.document.write(`<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Worksheet ‚Äì ${currentLesson.title}</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: "Nunito", "Comic Neue", "Andika", "Century Gothic", "Trebuchet MS", "Verdana", sans-serif;
    color: #303030;
    line-height: 1.55;
    font-size: 11.5pt;
    padding: 0;
    margin: 0;
    background: #fff;
  }

  .ws-page {
    max-width: 210mm;
    margin: 0 auto;
    padding: 18mm 16mm 14mm;
  }

  /* Header banner */
  .ws-header {
    background: linear-gradient(135deg, #075E54, #128C7E);
    color: #fff;
    border-radius: 12px;
    padding: 16px 22px;
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 14px;
  }
  .ws-header-icon {
    font-size: 2rem;
    background: rgba(255,255,255,0.15);
    border-radius: 12px;
    width: 52px; height: 52px;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
  }
  .ws-header h1 {
    font-size: 15pt;
    font-weight: 800;
    margin-bottom: 2px;
    line-height: 1.2;
  }
  .ws-header .ws-subtitle {
    font-size: 9.5pt;
    opacity: 0.9;
  }

  /* Info strip */
  .ws-info {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 14px;
  }
  .ws-info-chip {
    background: #f0f7f0;
    border: 1.5px solid #25D366;
    border-radius: 8px;
    padding: 6px 14px;
    font-size: 10pt;
    font-weight: 600;
    display: flex; align-items: center; gap: 6px;
  }
  .ws-info-chip.score {
    background: #FFF8E1;
    border-color: #F1C40F;
  }
  .ws-info-chip.name {
    background: #E8F5E9;
    border-color: #075E54;
    font-size: 11pt;
    font-weight: 700;
    color: #075E54;
  }

  /* Goals */
  .ws-goals {
    background: #E8F5E9;
    border-left: 5px solid #25D366;
    border-radius: 0 10px 10px 0;
    padding: 12px 16px;
    margin-bottom: 16px;
  }
  .ws-goals h3 {
    font-size: 10.5pt;
    color: #075E54;
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .ws-goals ul {
    margin: 0; padding-left: 18px;
    font-size: 10pt;
  }
  .ws-goals li {
    margin-bottom: 3px;
  }

  /* Questions */
  .ws-question {
    border: 1.5px solid #e0e0e0;
    border-radius: 10px;
    padding: 12px 14px;
    margin-bottom: 10px;
    page-break-inside: avoid;
  }
  .ws-question.correct { border-color: #28A745; background: #f6fdf7; }
  .ws-question.incorrect { border-color: #DC3545; background: #fef7f7; }
  .ws-question.unanswered { border-color: #ccc; background: #fafafa; }

  .ws-q-header {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
  }
  .ws-q-num {
    font-weight: 800;
    font-size: 11pt;
    color: #075E54;
    min-width: 22px;
  }
  .ws-q-icon { font-size: 13pt; }
  .ws-q-text {
    font-weight: 700;
    font-size: 10.5pt;
    margin-bottom: 6px;
  }
  .ws-q-answer, .ws-q-correct {
    font-size: 10pt;
    margin-bottom: 4px;
    padding: 4px 10px;
    border-radius: 6px;
  }
  .ws-q-answer {
    background: #f5f5f5;
  }
  .ws-question.correct .ws-q-answer { background: #d4edda; }
  .ws-question.incorrect .ws-q-answer { background: #f8d7da; }
  .ws-q-correct {
    background: #d4edda;
  }
  .ws-answer-label {
    font-weight: 700;
    font-size: 9pt;
    text-transform: uppercase;
    color: #666;
    margin-right: 6px;
  }
  .ws-answer-text {
    font-weight: 600;
  }
  .ws-q-explain {
    font-size: 9.5pt;
    color: #555;
    margin-top: 5px;
    padding-top: 5px;
    border-top: 1px dashed #ddd;
  }

  /* Score summary */
  .ws-score-box {
    background: linear-gradient(135deg, #075E54, #128C7E);
    color: #fff;
    border-radius: 12px;
    padding: 16px 22px;
    margin: 18px 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 10px;
  }
  .ws-score-big {
    font-size: 22pt;
    font-weight: 800;
  }
  .ws-score-detail {
    font-size: 10pt;
    opacity: 0.9;
  }
  .ws-score-bar-bg {
    width: 100%;
    height: 10px;
    background: rgba(255,255,255,0.25);
    border-radius: 5px;
    overflow: hidden;
    margin-top: 4px;
  }
  .ws-score-bar-fill {
    height: 100%;
    background: #25D366;
    border-radius: 5px;
    transition: width 0.3s;
  }

  /* Debrief */
  .ws-debrief {
    background: #FFF8E1;
    border: 1.5px solid #F1C40F;
    border-radius: 10px;
    padding: 14px 16px;
    margin-bottom: 14px;
    page-break-inside: avoid;
  }
  .ws-debrief h3 {
    font-size: 11pt;
    color: #5D4037;
    margin-bottom: 8px;
  }
  .ws-debrief p {
    font-size: 9.5pt;
    margin-bottom: 6px;
  }

  /* Reminder */
  .ws-reminder {
    background: #E3F2FD;
    border: 1.5px solid #2196F3;
    border-radius: 10px;
    padding: 12px 16px;
    text-align: center;
    font-size: 10pt;
    font-weight: 600;
    page-break-inside: avoid;
  }

  /* Footer */
  .ws-footer {
    margin-top: 20px;
    padding-top: 10px;
    border-top: 1px solid #ddd;
    display: flex;
    justify-content: space-between;
    font-size: 8pt;
    color: #999;
  }

  /* Signature line */
  .ws-signature {
    margin-top: 24px;
    display: flex;
    gap: 40px;
    flex-wrap: wrap;
  }
  .ws-sig-line {
    flex: 1;
    min-width: 180px;
    border-bottom: 1.5px solid #333;
    padding-bottom: 4px;
    font-size: 9pt;
    color: #666;
    font-weight: 600;
  }

  @media print {
    body { padding: 0; margin: 0; }
    .ws-page { padding: 12mm 14mm 10mm; }
    .ws-header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .ws-score-box { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .ws-question.correct { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .ws-question.incorrect { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  }
</style>
</head>
<body>
  <div class="ws-page">

    <div class="ws-header">
      <div class="ws-header-icon">üõ°Ô∏è</div>
      <div>
        <h1>Lesson ${currentLesson.id}: ${currentLesson.title}</h1>
        <div class="ws-subtitle">Nepean School ‚Äì WhatsApp Group Chat Safety ‚Äì Practice Worksheet</div>
      </div>
    </div>

    <div class="ws-info">
      <div class="ws-info-chip name">üë§ ${studentName}</div>
      <div class="ws-info-chip">üìÖ ${today}</div>
      <div class="ws-info-chip score">‚≠ê Score: ${correctCount} / ${totalQs}</div>
    </div>

    ${goalsHTML ? `
    <div class="ws-goals">
      <h3>üéØ Learning Goals</h3>
      <ul>${goalsHTML}</ul>
    </div>` : ''}

    ${debriefHTML}

    <h2 style="font-size:13pt;color:#075E54;margin-bottom:12px;">üìù Practice Questions &amp; Answers</h2>

    ${questionsHTML}

    <div class="ws-score-box">
      <div>
        <div class="ws-score-big">${correctCount} / ${totalQs}</div>
        <div class="ws-score-detail">${answered} of ${totalQs} questions answered</div>
      </div>
      <div style="flex:1;min-width:120px;max-width:260px;">
        <div class="ws-score-detail">${Math.round((correctCount / totalQs) * 100)}% correct</div>
        <div class="ws-score-bar-bg">
          <div class="ws-score-bar-fill" style="width:${Math.round((correctCount / totalQs) * 100)}%"></div>
        </div>
      </div>
    </div>

    <div class="ws-reminder">
      üîî Remember: If something ever feels wrong online, tell a trusted adult. You're never in trouble for asking for help.<br>
      üíö Nepean School Wellbeing Team: Sarah Bylart
    </div>

    <div class="ws-signature">
      <div class="ws-sig-line">Student signature</div>
      <div class="ws-sig-line">Teacher / Parent signature</div>
    </div>

    <div class="ws-footer">
      <span>Nepean School ‚Äì WhatsApp Group Chat Safety</span>
      <span>Lesson ${currentLesson.id} of 22</span>
    </div>

  </div>

  <script>
    window.onload = function() {
      setTimeout(function() { window.print(); }, 400);
    };
  <\/script>
</body>
</html>`);

  printWindow.document.close();
}

// Navigation
function goHome() {
  document.getElementById('sim-container').classList.remove('active');
  document.getElementById('intro').classList.add('hidden');
  document.getElementById('landing').classList.add('hidden');
  document.getElementById('splash').style.display = 'flex';
  window.scrollTo(0, 0);
}

function restartLesson() {
  if (currentLesson) startLesson(currentLesson.id);
}

// Help panel
function toggleHelp() {
  document.getElementById('helpOverlay').classList.toggle('show');
  document.getElementById('helpPanel').classList.toggle('show');
}

function toggleTrusted() {
  document.getElementById('trustedContacts').classList.toggle('show');
}

// Accessibility
function toggleA11y(mode) {
  if (mode === 'easy-read') {
    easyRead = !easyRead;
    document.body.classList.toggle('easy-read', easyRead);
    document.getElementById('btnEasyRead').classList.toggle('on', easyRead);
  } else if (mode === 'reduce-clutter') {
    reduceClutter = !reduceClutter;
    document.body.classList.toggle('reduce-clutter', reduceClutter);
    document.getElementById('btnClutter').classList.toggle('on', reduceClutter);
  } else if (mode === 'hint') {
    if (!currentLesson || currentStep >= currentLesson.steps.length) return;
    const hint = currentLesson.steps[currentStep].hint;
    if (hint) {
      const feedbackPanel = document.getElementById('feedbackPanel');
      feedbackPanel.classList.remove('good', 'caution', 'bad');
      feedbackPanel.classList.add('show', 'caution');
      document.getElementById('feedbackTitle').textContent = 'üí° Hint';
      document.getElementById('feedbackText').textContent = hint;
      document.getElementById('feedbackNext').style.display = 'none';
      document.getElementById('feedbackRetry').style.display = 'none';
      setTimeout(() => {
        document.getElementById('feedbackNext').style.display = '';
      }, 100);
      // Hide hint feedback after a moment if user doesn't do anything
    }
  } else if (mode === 'read-aloud') {
    // Simple read-aloud using Web Speech API
    const btn = document.getElementById('btnReadAloud');
    if (window.speechSynthesis.speaking) {
      window.speechSynthesis.cancel();
      btn.classList.remove('on');
      return;
    }
    btn.classList.add('on');
    const chatArea = document.getElementById('chatArea');
    const text = chatArea.innerText;
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.rate = 0.9;
    utterance.onend = () => btn.classList.remove('on');
    window.speechSynthesis.speak(utterance);
  }
}

// ============================================================
// INTRO PAGE ‚Äì typing + portal transition
// ============================================================
const INTRO_TOP_TEXT = "Nepean School";
const INTRO_BOTTOM_TEXT = "WhatsApp Group Chat Safety";

let introTopIdx = 0;
let introBottomIdx = 0;
let introReady = false;

function startIntroTyping() {
  const topEl = document.getElementById('introTopText');
  const topCursor = document.getElementById('introTopCursor');
  const bottomEl = document.getElementById('introBottomText');
  const bottomCursor = document.getElementById('introBottomCursor');
  const hint = document.getElementById('introClickHint');

  introTopIdx = 0;
  introBottomIdx = 0;
  topEl.textContent = '';
  bottomEl.textContent = '';

  function typeTop() {
    if (introTopIdx < INTRO_TOP_TEXT.length) {
      topEl.textContent += INTRO_TOP_TEXT[introTopIdx];
      introTopIdx++;
      setTimeout(typeTop, 65);
    } else {
      // Top done, start bottom
      topCursor.style.display = 'none';
      bottomCursor.style.display = '';
      setTimeout(typeBottom, 300);
    }
  }

  function typeBottom() {
    if (introBottomIdx < INTRO_BOTTOM_TEXT.length) {
      bottomEl.textContent += INTRO_BOTTOM_TEXT[introBottomIdx];
      introBottomIdx++;
      setTimeout(typeBottom, 45);
    } else {
      // All done
      bottomCursor.style.display = 'none';
      hint.classList.add('show');
      introReady = true;
    }
  }

  setTimeout(typeTop, 600);
}

function triggerPortal() {
  if (!introReady) {
    // Skip typing, fill text immediately
    document.getElementById('introTopText').textContent = INTRO_TOP_TEXT;
    document.getElementById('introBottomText').textContent = INTRO_BOTTOM_TEXT;
    document.getElementById('introTopCursor').style.display = 'none';
    document.getElementById('introBottomCursor').style.display = 'none';
    document.getElementById('introClickHint').classList.add('show');
    introReady = true;
    return; // First tap skips typing; second tap enters
  }

  const intro = document.getElementById('intro');
  intro.classList.add('portal-out');

  // After zoom animation, hide intro and show landing
  setTimeout(() => {
    intro.classList.add('hidden');
    const landing = document.getElementById('landing');
    landing.classList.remove('hidden');
    startTyping();
    window.scrollTo(0, 0);

    // Play hero audio after 2 seconds
    setTimeout(() => {
      const audio = document.getElementById('heroAudio');
      if (audio) {
        audio.play().catch(() => {
          // Autoplay may be blocked; that's okay
        });
      }
    }, 2000);
  }, 900);
}

// ============================================================
// LANDING PAGE ‚Äì typing animation
// ============================================================
const WELCOME_MSG = "Hey! üëã Staying connected in group chats is awesome‚Ä¶ but sometimes things come up that aren't so cool. Weird messages, pressure to share stuff, people being mean ‚Äî it happens. This is your guide to handling all of it like a boss. üí™ Ready? Hit the button and let's go! üëá";

let typingIdx = 0;
let typingTimer = null;

function startTyping() {
  const el = document.getElementById('typedText');
  const cursor = document.getElementById('typingCursor');
  const timeEl = document.getElementById('bubbleTime');
  const enterBtn = document.getElementById('enterBtn');
  if (!el) return;

  typingIdx = 0;
  el.textContent = '';

  function typeNext() {
    if (typingIdx < WELCOME_MSG.length) {
      el.textContent += WELCOME_MSG[typingIdx];
      typingIdx++;
      // Vary speed for natural feel
      const char = WELCOME_MSG[typingIdx - 1];
      let delay = 28;
      if (char === '.' || char === '!' || char === '?') delay = 320;
      else if (char === ',') delay = 160;
      else if (char === '‚Ä¶') delay = 280;
      else if (char === ' ') delay = 40;
      typingTimer = setTimeout(typeNext, delay);
    } else {
      // Typing done
      cursor.style.display = 'none';
      timeEl.style.display = '';
      enterBtn.style.opacity = '1';
      enterBtn.style.pointerEvents = 'auto';
      enterBtn.style.animation = 'enterBtnAppear 0.5s ease forwards';
    }
  }
  typeNext();
}

function enterApp() {
  if (typingTimer) clearTimeout(typingTimer);
  document.getElementById('landing').classList.add('hidden');
  document.getElementById('splash').style.display = 'flex';
  window.scrollTo(0, 0);
}

// Allow skipping the typing by clicking the bubble
document.addEventListener('DOMContentLoaded', function() {
  const bubble = document.querySelector('.landing-bubble');
  if (bubble) {
    bubble.addEventListener('click', function() {
      if (typingIdx < WELCOME_MSG.length) {
        // Skip to end
        if (typingTimer) clearTimeout(typingTimer);
        document.getElementById('typedText').textContent = WELCOME_MSG;
        document.getElementById('typingCursor').style.display = 'none';
        document.getElementById('bubbleTime').style.display = '';
        const enterBtn = document.getElementById('enterBtn');
        enterBtn.style.opacity = '1';
        enterBtn.style.pointerEvents = 'auto';
        typingIdx = WELCOME_MSG.length;
      }
    });
  }
});

// Init
startIntroTyping();
buildTOC();
</script>

</body>
</html>
